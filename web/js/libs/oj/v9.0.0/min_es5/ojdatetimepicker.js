/**
 * @license
 * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["ojs/ojcore","jquery","hammerjs","ojs/ojcontext","ojs/ojthemeutils","ojs/ojcomponentcore","ojs/ojeditablevalue","ojs/ojinputtext","ojs/ojlocaledata","ojs/ojconverterutils","ojs/ojconverterutils-i18n","ojs/ojconverter-datetime","ojs/ojvalidator-datetimerange","ojs/ojvalidator-daterestriction","ojs/ojanimation","ojs/ojlogger","ojs/ojconfig","ojs/ojpopup","ojs/ojbutton"],function(e,t,i,n,r,a,s,o,l,c,u,h,d,p,_,m,v){"use strict";var f={properties:{asyncValidators:{type:"Array<Object>",value:[]},autocomplete:{type:"string",value:"on",extension:{_COPY_TO_INNER_ELEM:!0}},autofocus:{type:"boolean",value:!1,extension:{_COPY_TO_INNER_ELEM:!0}},converter:{type:"object"},datePicker:{type:"object",properties:{changeMonth:{type:"string",enumValues:["none","select"],value:"select"},changeYear:{type:"string",enumValues:["none","select"],value:"select"},currentMonthPos:{type:"number",value:0},daysOutsideMonth:{type:"string",enumValues:["hidden","selectable","visible"],value:"hidden"},footerLayout:{type:"string",enumValues:["","today"],value:"today"},numberOfMonths:{type:"number",value:1},showOn:{type:"string",enumValues:["focus","image"],value:"focus"},stepBigMonths:{type:"number",value:12},stepMonths:{type:"string|number",value:"numberOfMonths"},weekDisplay:{type:"string",enumValues:["none","number"],value:"none"},yearRange:{type:"string",value:"c-10:c+10"}}},dayFormatter:{type:"function"},dayMetaData:{type:"object"},describedBy:{type:"string"},disabled:{type:"boolean",value:!1},displayOptions:{type:"object",properties:{converterHint:{type:"Array<string>|string",value:["placeholder","notewindow"]},helpInstruction:{type:"Array<string>|string",value:["notewindow"]},messages:{type:"Array<string>|string",value:["inline"]},validatorHint:{type:"Array<string>|string",value:["notewindow"]}}},help:{type:"object",properties:{instruction:{type:"string",value:""}}},helpHints:{type:"object",properties:{definition:{type:"string",value:""},source:{type:"string",value:""}}},keyboardEdit:{type:"string",enumValues:["disabled","enabled"]},labelEdge:{type:"string",enumValues:["inside","none","provided"]},labelHint:{type:"string",value:""},labelledBy:{type:"string"},max:{type:"string"},messagesCustom:{type:"Array<Object>",writeback:!0,value:[]},min:{type:"string"},name:{type:"string",value:"",extension:{_COPY_TO_INNER_ELEM:!0}},pickerAttributes:{type:"object",properties:{style:{type:"string"},class:{type:"string"}}},placeholder:{type:"string"},rawValue:{type:"string",writeback:!0,readOnly:!0},readonly:{type:"boolean",value:!1},renderMode:{type:"string",enumValues:["jet","native"]},required:{type:"boolean",value:!1},translations:{type:"object",value:{},properties:{accessibleMaxLengthExceeded:{type:"string"},accessibleMaxLengthRemaining:{type:"string"},currentText:{type:"string"},dateRestriction:{type:"object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},dateTimeRange:{type:"object",properties:{hint:{type:"object",properties:{inRange:{type:"string"},max:{type:"string"},min:{type:"string"}}},messageDetail:{type:"object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}},messageSummary:{type:"object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}}}},nextText:{type:"string"},prevText:{type:"string"},regexp:{type:"object",properties:{messageDetail:{type:"string"},messageSummary:{type:"string"}}},required:{type:"object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},tooltipCalendar:{type:"string"},tooltipCalendarDisabled:{type:"string"},tooltipCalendarTime:{type:"string"},tooltipCalendarTimeDisabled:{type:"string"},weekHeader:{type:"string"}}},userAssistanceDensity:{type:"string",enumValues:["compact","efficient","reflow"],value:"reflow"},valid:{type:"string",writeback:!0,enumValues:["invalidHidden","invalidShown","pending","valid"],readOnly:!0},validators:{type:"Array<Object>",value:[]},value:{type:"string",writeback:!0}},methods:{hide:{},refresh:{},show:{},validate:{},reset:{},showMessages:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojAnimateStart:{},ojAnimateEnd:{}},extension:{}},g={properties:{asyncValidators:{type:"Array<Object>",value:[]},autocomplete:{type:"string",value:"on",extension:{_COPY_TO_INNER_ELEM:!0}},autofocus:{type:"boolean",value:!1,extension:{_COPY_TO_INNER_ELEM:!0}},converter:{type:"object"},datePicker:{type:"object",properties:{changeMonth:{type:"string",enumValues:["none","select"],value:"select"},changeYear:{type:"string",enumValues:["none","select"],value:"select"},currentMonthPos:{type:"number",value:0},daysOutsideMonth:{type:"string",enumValues:["hidden","selectable","visible"],value:"hidden"},footerLayout:{type:"string",enumValues:["","today"],value:"today"},numberOfMonths:{type:"number",value:1},showOn:{type:"string",enumValues:["focus","image"],value:"focus"},stepBigMonths:{type:"number",value:12},stepMonths:{type:"string|number",value:"numberOfMonths"},weekDisplay:{type:"string",enumValues:["none","number"],value:"none"},yearRange:{type:"string",value:"c-10:c+10"}}},dayFormatter:{type:"function"},dayMetaData:{type:"object"},describedBy:{type:"string"},disabled:{type:"boolean",value:!1},displayOptions:{type:"object",properties:{converterHint:{type:"Array<string>|string",value:["placeholder","notewindow"]},helpInstruction:{type:"Array<string>|string",value:["notewindow"]},messages:{type:"Array<string>|string",value:["inline"]},validatorHint:{type:"Array<string>|string",value:["notewindow"]}}},help:{type:"object",properties:{instruction:{type:"string",value:""}}},helpHints:{type:"object",properties:{definition:{type:"string",value:""},source:{type:"string",value:""}}},keyboardEdit:{type:"string",enumValues:["disabled","enabled"]},labelEdge:{type:"string",enumValues:["inside","none","provided"]},labelHint:{type:"string",value:""},labelledBy:{type:"string"},max:{type:"string"},messagesCustom:{type:"Array<Object>",writeback:!0,value:[]},min:{type:"string"},name:{type:"string",value:"",extension:{_COPY_TO_INNER_ELEM:!0}},pickerAttributes:{type:"object",properties:{style:{type:"string"},class:{type:"string"}}},placeholder:{type:"string"},rawValue:{type:"string",writeback:!0,readOnly:!0},readonly:{type:"boolean",value:!1},renderMode:{type:"string",enumValues:["jet","native"]},required:{type:"boolean",value:!1},timePicker:{type:"object",properties:{footerLayout:{type:"string",enumValues:["","now"],value:""},showOn:{type:"string",enumValues:["focus","image"],value:"focus"},timeIncrement:{type:"string",value:"00:05:00:00"}}},translations:{type:"object",value:{},properties:{accessibleMaxLengthExceeded:{type:"string"},accessibleMaxLengthRemaining:{type:"string"},cancel:{type:"string"},currentText:{type:"string"},dateRestriction:{type:"object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},dateTimeRange:{type:"object",properties:{hint:{type:"object",properties:{inRange:{type:"string"},max:{type:"string"},min:{type:"string"}}},messageDetail:{type:"object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}},messageSummary:{type:"object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}}}},done:{type:"string"},nextText:{type:"string"},prevText:{type:"string"},regexp:{type:"object",properties:{messageDetail:{type:"string"},messageSummary:{type:"string"}}},required:{type:"object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},tooltipCalendar:{type:"string"},tooltipCalendarDisabled:{type:"string"},tooltipCalendarTime:{type:"string"},tooltipCalendarTimeDisabled:{type:"string"},weekHeader:{type:"string"}}},userAssistanceDensity:{type:"string",enumValues:["compact","efficient","reflow"],value:"reflow"},valid:{type:"string",writeback:!0,enumValues:["invalidHidden","invalidShown","pending","valid"],readOnly:!0},validators:{type:"Array<Object>",value:[]},value:{type:"string",writeback:!0}},methods:{show:{},showTimePicker:{},hideTimePicker:{},hide:{},refresh:{},validate:{},reset:{},showMessages:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojAnimateStart:{},ojAnimateEnd:{}},extension:{}},y={properties:{asyncValidators:{type:"Array<Object>",value:[]},autocomplete:{type:"string",value:"on",extension:{_COPY_TO_INNER_ELEM:!0}},autofocus:{type:"boolean",value:!1,extension:{_COPY_TO_INNER_ELEM:!0}},converter:{type:"object"},describedBy:{type:"string"},disabled:{type:"boolean",value:!1},displayOptions:{type:"object",properties:{converterHint:{type:"Array<string>|string",value:["placeholder","notewindow"]},helpInstruction:{type:"Array<string>|string",value:["notewindow"]},messages:{type:"Array<string>|string",value:["inline"]},validatorHint:{type:"Array<string>|string",value:["notewindow"]}}},help:{type:"object",properties:{instruction:{type:"string",value:""}}},helpHints:{type:"object",properties:{definition:{type:"string",value:""},source:{type:"string",value:""}}},keyboardEdit:{type:"string",enumValues:["disabled","enabled"]},labelEdge:{type:"string",enumValues:["inside","none","provided"]},labelHint:{type:"string",value:""},labelledBy:{type:"string"},max:{type:"string"},messagesCustom:{type:"Array<Object>",writeback:!0,value:[]},min:{type:"string"},name:{type:"string",value:"",extension:{_COPY_TO_INNER_ELEM:!0}},pickerAttributes:{type:"object",properties:{style:{type:"string"},class:{type:"string"}}},placeholder:{type:"string"},rawValue:{type:"string",writeback:!0,readOnly:!0},readonly:{type:"boolean",value:!1},renderMode:{type:"string",enumValues:["jet","native"]},required:{type:"boolean",value:!1},timePicker:{type:"object",properties:{footerLayout:{type:"string",enumValues:["","now"],value:""},showOn:{type:"string",enumValues:["focus","image"],value:"focus"},timeIncrement:{type:"string",value:"00:05:00:00"}}},translations:{type:"object",value:{},properties:{accessibleMaxLengthExceeded:{type:"string"},accessibleMaxLengthRemaining:{type:"string"},ampmWheelLabel:{type:"string"},cancelText:{type:"string"},currentTimeText:{type:"string"},dateTimeRange:{type:"object",properties:{hint:{type:"object",properties:{inRange:{type:"string"},max:{type:"string"},min:{type:"string"}}},messageDetail:{type:"object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}},messageSummary:{type:"object",properties:{rangeOverflow:{type:"string"},rangeUnderflow:{type:"string"}}}}},hourWheelLabel:{type:"string"},minuteWheelLabel:{type:"string"},okText:{type:"string"},regexp:{type:"object",properties:{messageDetail:{type:"string"},messageSummary:{type:"string"}}},required:{type:"object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}},tooltipTime:{type:"string"},tooltipTimeDisabled:{type:"string"}}},userAssistanceDensity:{type:"string",enumValues:["compact","efficient","reflow"],value:"reflow"},valid:{type:"string",writeback:!0,enumValues:["invalidHidden","invalidShown","pending","valid"],readOnly:!0},validators:{type:"Array<Object>",value:[]},value:{type:"string",writeback:!0}},methods:{show:{},hide:{},refresh:{},validate:{},reset:{},showMessages:{},setProperty:{},getProperty:{},setProperties:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojAnimateStart:{},ojAnimateEnd:{}},extension:{}},D=(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).converterYear||"numeric";function k(){return"phone"!==v.getDeviceRenderMode()}function b(e,t){t=e.parse(t);var i,n=new Date;try{i=u.IntlConverterUtils._dateTime(t,["date","fullYear","month","hours","minutes","seconds"],!0)}catch(e){return m.info("The value of the InputDateTime element should be an ISOString, please use a valid ISOString"),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n}return n.setFullYear(i.fullYear),n.setDate(i.date),n.setMonth(i.month),n.setHours(i.hours),n.setMinutes(i.minutes),n.setSeconds(i.seconds),n.setMilliseconds(0),n}function S(e){return this.options.converter&&this.options.converter.parse?this.options.converter.parse(e):e}function C(e,i,n){var r=e.translations.dateTimeRange||{},a=[{category:"hint",entries:["min","max","inRange"]},{category:"messageDetail",entries:["rangeUnderflow","rangeOverflow"]},{category:"messageSummary",entries:["rangeUnderflow","rangeOverflow"]}],s={min:e.min,max:e.max,converter:i,translationKey:{"oj-inputdatetime":"datetime","oj-inputtime":"time","oj-inputdate":"date"}[n]};if(!t.isEmptyObject(r))for(var o=0,l=a.length;o<l;o++){var c=r[a[o].category];if(c){for(var u={},h=a[o].entries,p=0,_=h.length;p<_;p++)u[h[p]]=c[h[p]];s[a[o].category]=u}}return new d(s)}function w(e,i){var n={dayFormatter:e.dayFormatter,converter:i};return t.extend(n,e.translations.dateRestriction||{}),new p(n)}function I(e,t){for(var i=0;i<e.length;i++){var n=e[i];"SPAN"===n.tagName&&(t?(n.classList.add("oj-disabled"),n.classList.remove("oj-enabled"),n.classList.remove("oj-default")):(n.classList.remove("oj-disabled"),n.classList.add("oj-enabled"),n.classList.add("oj-default")))}}function j(e,t,i){if(!e||t===i.length)return e;var n=t+1;return j(e[i[t]],n,i)||j(e["*"],n,i)}function E(e){var i;i=e._isInLine?e.element[0].parentNode:e.element[0].parentNode.parentNode,e._AddActiveable(t(i))}function P(e){return"native"===e.options.renderMode&&window.cordova&&window.datePicker}var O=new h.IntlDateTimeConverter({year:"numeric"});function T(e,t){return O.format(u.IntlConverterUtils.dateToLocalIso(new Date(e,t,1)))}e.__registerWidget("oj.ojInputDate",t.oj.inputBase,{widgetEventPrefix:"oj",_CLASS_NAMES:"oj-inputdatetime-input",_WIDGET_CLASS_NAMES:"oj-inputdatetime-date-only oj-component oj-inputdatetime",_ELEMENT_TRIGGER_WRAPPER_CLASS_NAMES:"",_INPUT_HELPER_KEY:"inputHelp",_ATTR_CHECK:[{attr:"type",setMandatory:"text"}],_GET_INIT_OPTIONS_PROPS_FOR_WIDGET:[{attribute:"disabled",validateOption:!0},{attribute:"pattern"},{attribute:"title"},{attribute:"placeholder"},{attribute:"value",coerceDomValue:S},{attribute:"required",coerceDomValue:!0,validateOption:!0},{attribute:"readonly",option:"readOnly",validateOption:!0},{attribute:"min",coerceDomValue:S},{attribute:"max",coerceDomValue:S}],_TRIGGER_CLASS:"oj-inputdatetime-input-trigger",_TRIGGER_CALENDAR_CLASS:"oj-inputdatetime-calendar-icon",_CURRENT_CLASS:"oj-datepicker-current-day",_DAYOVER_CLASS:"oj-datepicker-days-cell-over",_UNSELECTABLE_CLASS:"oj-datepicker-unselectable",_DATEPICKER_DIALOG_DESCRIPTION_ID:"oj-datepicker-dialog-desc",_DATEPICKER_DESCRIPTION_ID:"oj-datepicker-desc",_CALENDAR_DESCRIPTION_ID:"oj-datepicker-calendar",_MAIN_DIV_ID:"oj-datepicker-div",_INLINE_CLASS:"oj-datepicker-inline",_INPUT_CONTAINER_CLASS:" oj-inputdatetime-input-container oj-text-field-container",_INLINE_WIDGET_CLASS:" oj-inputdatetime-inline",_ON_CLOSE_REASON_SELECTION:"selection",_ON_CLOSE_REASON_CANCELLED:"cancelled",_ON_CLOSE_REASON_TAB:"tab",_ON_CLOSE_REASON_CLOSE:"close",_KEYBOARD_EDIT_OPTION_ENABLED:"enabled",_KEYBOARD_EDIT_OPTION_DISABLED:"disabled",options:{datePicker:{footerLayout:"",changeMonth:"select",changeYear:"select",currentMonthPos:0,daysOutsideMonth:"hidden",numberOfMonths:1,showOn:"focus",stepMonths:"numberOfMonths",stepBigMonths:12,weekDisplay:"none",yearRange:"c-10:c+10"},converter:new h.IntlDateTimeConverter({day:"2-digit",month:"2-digit",year:D}),keyboardEdit:"enabled",max:void 0,min:void 0,pickerAttributes:null,renderMode:"jet",dayFormatter:null},_InitBase:function(){this._triggerNode=null,this._inputContainer=null,this._redirectFocusToInputContainer=!1,this._isMobile=!1,this._ignoreShow=!1,this._nativePickerShowing=!1,this._maxRows=4,this._currentDay=0,this._drawMonth=0,this._currentMonth=0,this._drawYear=0,this._currentYear=0,this._datePickerDefaultValidators={},this._nativePickerConverter=null,this._labelValueWrapper=null;var e=this.element[0].nodeName.toLowerCase();this._isInLine="div"===e||"span"===e,this._isInLine?(this._createDpDiv(),this._WIDGET_CLASS_NAMES+=this._INLINE_WIDGET_CLASS,this._CLASS_NAMES=""):(this._ELEMENT_TRIGGER_WRAPPER_CLASS_NAMES+=this._INPUT_CONTAINER_CLASS,!0!==this.options.readOnly&&(this._createDpDiv(),this._createPopupDpDiv()))},_UseReadonlyDiv:function(){return!this._isInLine&&this._superApply(arguments)},_createDpDiv:function(){var e=document.createElement("div");e.className="oj-datepicker-popup",e.style.display="none";var i=document.createElement("div");i.id=this._GetSubId(this._MAIN_DIV_ID),i.setAttribute("role","region"),i.setAttribute("aria-describedby",this._GetSubId(this._DATEPICKER_DESCRIPTION_ID)),i.className="oj-datepicker-content",e.appendChild(i),this._dpDiv=function(e){var t=".oj-datepicker-prev-icon, .oj-datepicker-prev-icon .oj-clickable-icon-nocontext.oj-component-icon, .oj-datepicker-next-icon, .oj-datepicker-next-icon .oj-clickable-icon-nocontext.oj-component-icon, .oj-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){this.classList.remove("oj-hover")}).delegate(t,"mouseover",function(){this.classList.add("oj-hover")}).delegate(t,"focus",function(){this.classList.add("oj-focus")}).delegate(t,"blur",function(){this.classList.remove("oj-focus")})}(t(e)),document.body.appendChild(e)},_createPopupDpDiv:function(){var t=this;this._popUpDpDiv=this._dpDiv.ojPopup({initialFocus:"none",role:"dialog",modality:k()?"modeless":"modal",open:function(){t._popUpDpDiv.attr("aria-describedby",t._GetSubId(t._DATEPICKER_DIALOG_DESCRIPTION_ID)),"image"===t.options.datePicker.showOn&&t._dpDiv.find(".oj-datepicker-calendar").focus()},animation:{open:null,close:null}}).attr("data-oj-internal",""),this.element.attr("data-oj-popup-"+this._popUpDpDiv.attr("id")+"-parent","");var i=this.options.pickerAttributes;i&&e.EditableValueUtils.setPickerAttributes(this._popUpDpDiv.ojPopup("widget"),i)},_GetDefaultConverter:function(){return new h.IntlDateTimeConverter({day:"2-digit",month:"2-digit",year:"2-digit"})},_CreateConverters:function(){var e=this._GetConverter();if(e instanceof Promise){var t=this;this._resolveDateConverterBusyState=this._SetConverterBusyState("date"),this._dateConverterPromise=e.then(function(e){t._createNativeDatePickerConverter(e)})}else this._createNativeDatePickerConverter(e)},_ComponentCreate:function(){this._CreateConverters(),this._InitBase();var e,t=this._super();return this.options.dayMetaData&&(this.options.dayFormatter=(e=this.options.dayMetaData,function(t){return j(e,0,[t.fullYear,t.month,t.date])})),this._setCurrentDate(this._getDateIso()),this._isInLine?(this.element.append(this._dpDiv),this.element.addClass(this._INLINE_CLASS),this.element.addClass("oj-form-control-container"),this._dpDiv.css("display","block"),this._registerSwipeHandler()):(this._processReadOnlyKeyboardEdit(),!0!==this.options.readOnly&&(this._attachTrigger(),this._registerSwipeHandler())),E(this),t},_SetConverterBusyState:function(e){var t=this.element[0],i=n.getContext(t).getBusyContext(),r="The page is waiting for async "+e+" converter loading ";return t&&t.id&&(r+='for "'+t.id+'" '),r+="to finish.",i.addBusyState({description:r})},_IsDisabled:function(){return this.options.disabled||!this._converterCached},_AfterCreate:function(){var e,t=this._superApply(arguments);if(this._disableEnable(this._IsDisabled()),!this._IsCustomElement()){var i=this.$label;this._inputContainer&&i&&1===i.length&&(e=i.attr("id"),this._inputContainer.attr("aria-labelledby",e))}return t},_AfterCreateConverterCached:function(){var e=this._super();this._converterCached=!0;var t=function(){this._disableEnable(this._IsDisabled()),this._resolveDateConverterBusyState&&(this._resolveDateConverterBusyState(),delete this._resolveDateConverterBusyState)}.bind(this);if(this._dateConverterPromise){var i=this;this._dateConverterPromise.then(function(){t(),delete i._dateConverterPromise})}else t();return e},_setValidatorOption:function(e,t){var i=this,n=function(t){i._datePickerDefaultValidators[e]=t,i._AfterSetOptionValidators()};t instanceof Promise?t.then(function(e){n(e)}):n(t)},_setOption:function(t,i,n){var r=null;if("value"===t){if(i||(i=null),r=this._super(t,i,n),this._setCurrentDate(i),this._datepickerShowing()){var a=!(this._isInLine&&!this._dpDiv[0].contains(document.activeElement));this._updateDatepicker(a)}return r}if("dayMetaData"!==t){r=this._super(t,i,n),"disabled"===t?this._disableEnable(i):"max"===t||"min"===t?this._setValidatorOption("dateTimeRange",this._createDateTimeRangeValidator(this._GetConverter())):"readOnly"===t?(this._isInLine||i||null!=this._dpDiv||(this._createDpDiv(),this._createPopupDpDiv(),this._attachTrigger(),this._registerSwipeHandler(),this._AppendInputHelper(),this._setupResizePopupBind()),this._processReadOnlyKeyboardEdit(),i&&this._hide(this._ON_CLOSE_REASON_CLOSE),this._AfterSetOptionDisabledReadOnly("readOnly",e.EditableValueUtils.readOnlyOptionOptions)):"keyboardEdit"===t?this._processReadOnlyKeyboardEdit():"dayFormatter"===t?this._setValidatorOption("dateRestriction",this._createDateRestrictionValidator(this._GetConverter())):"converter"===t&&(this._nativePickerConverter=null),"datePicker"===t&&"currentMonthPos"===n.subkey&&this._setCurrentDate(this._getDateIso());return this._datepickerShowing()&&t in{max:!0,min:!0,dayFormatter:!0,datePicker:!0,translations:!0}&&this._updateDatepicker(),r}this.option("dayFormatter",function(e){return j(i,0,[e.fullYear,e.month,e.date])},n)},_processReadOnlyKeyboardEdit:function(){var e=this.options.readOnly||this._isKeyboardEditDisabled();this.element.prop("readOnly",!!e)},_isKeyboardEditDisabled:function(){return this.options.keyboardEdit===this._KEYBOARD_EDIT_OPTION_DISABLED},_AppendInputHelperParent:function(){return this._triggerNode},_destroy:function(){return this._cleanUpDateResources(),this._super()},_datepickerShowing:function(){return this._isInLine||this._popUpDpDiv&&a.isComponentInitialized(this._popUpDpDiv,"ojPopup")&&this._popUpDpDiv.ojPopup("isOpen")||this._nativePickerShowing},_SetupResources:function(){return this._isInLine||!0!==this.options.readOnly&&this._setupResizePopupBind(),this._super()},_SetLoading:function(){this._super(),this.element.prop("readOnly",!0),this._hide(this._ON_CLOSE_REASON_CLOSE)},_ClearLoading:function(){this._super(),this._processReadOnlyKeyboardEdit()},_setupResizePopupBind:function(){this._resizePopupBind=function(){a.isComponentInitialized(this._popUpDpDiv,"ojPopup")&&this._popUpDpDiv.ojPopup("option","modality",k()?"modeless":"modal")}.bind(this),window.addEventListener("resize",this._resizePopupBind,!1)},_ReleaseResources:function(){return this._IsCustomElement()&&this._cleanUpListeners(),this._super()},_cleanUpDateResources:function(){var e;e=this._isInLine?this.element[0].parentNode:this.element[0].parentNode.parentNode.parentNode,this._RemoveActiveable(t(e)),this.element.off("focus"),this.element[0].removeEventListener("touchstart",this._datepickerTouchStartListener,{passive:!1}),delete this._datepickerTouchStartListener,this._wrapper[0].removeEventListener("touchstart",this._datepickerWrapperTouchStartListener,{passive:!0}),delete this._datepickerWrapperTouchStartListener,this._triggerNode&&this._triggerNode.remove(),this._isInLine&&(this.element.removeProp("disabled"),this.element.removeProp("readonly")),this._cleanUpListeners(),this._animationResolve&&(this._animationResolve(),this._animationResolve=null),this._popUpDpDiv&&a.isComponentInitialized(this._popUpDpDiv,"ojPopup")&&this._popUpDpDiv.ojPopup("destroy"),this._dpDiv&&this._dpDiv.remove()},_cleanUpListeners:function(){this._resizePopupBind&&window.removeEventListener("resize",this._resizePopupBind)},_CreateContainerWrapper:function(){return this._inputContainer=t(this._superApply(arguments)),this._inputContainer.attr({role:"presentation",tabindex:"-1"}),this.element.attr({role:"combobox","aria-haspopup":"true"}),this._inputContainer[0]},_CreateMiddleWrapper:function(e){var t;return this._isInLine?this._labelValueWrapper=this.element[0]:(t=this._superApply(arguments),this._labelValueWrapper=t),t},_IsTextFieldComponent:function(){return!this._isInLine},_GetContentWrapper:function(){if(this._IsCustomElement()&&!this._isInLine)return this._getRootElement().querySelector(".oj-text-field-middle")},_onElementFocus:function(){var e=this.options.datePicker.showOn;this._redirectFocusToInputContainer?(this._redirectFocusToInputContainer=!1,this._inputContainer.focus()):"focus"===e?this.show():this._datepickerShowing()&&this._hide(this._ON_CLOSE_REASON_CLOSE)},_OnElementTouchStart:function(e){if(e.preventDefault(),"focus"===this.options.datePicker.showOn)if(this._datepickerShowing())this._ignoreShow=!0,this._hide(this._ON_CLOSE_REASON_CLOSE);else{var t=this.element[0]===document.activeElement;this.show(),this._redirectFocusToInputContainer=!0,t&&this._inputContainer.focus()}},_attachTrigger:function(){var e=this.options.datePicker.showOn,i=document.createElement("span");i.className=this._TRIGGER_CLASS;var n=document.createElement("span");n.setAttribute("title",this._GetCalendarTitle()),n.className=this._TRIGGER_CALENDAR_CLASS+" oj-clickable-icon-nocontext oj-component-icon",i.appendChild(n),this.element.on("focus",t.proxy(this._onElementFocus,this)),this._datepickerTouchStartListener=t.proxy(this._OnElementTouchStart,this),this.element[0].addEventListener("touchstart",this._datepickerTouchStartListener,{passive:!1});var r=this;this._datepickerWrapperTouchStartListener=function(){r._isMobile=!0},this._wrapper[0].addEventListener("touchstart",this._datepickerWrapperTouchStartListener,{passive:!0}),"image"===e&&(n.style.display="block",this._IsRTL()?(this.element.css("border-top-left-radius",0),this.element.css("border-bottom-left-radius",0)):(this.element.css("border-top-right-radius",0),this.element.css("border-bottom-right-radius",0))),n.addEventListener("click",function(e){r._datepickerShowing()?r._hide(r._ON_CLOSE_REASON_CLOSE):(r.show(),r._dpDiv.find(".oj-datepicker-calendar").focus()),e.preventDefault(),e.stopPropagation()});var a=t(n);this._AddHoverable(a),this._AddActiveable(a),this._triggerIcon=a,this._triggerNode=t(i),this._labelValueWrapper.parentNode.insertBefore(i,this._labelValueWrapper.nextElementSibling)},_doCalendarKeyDown:function(e){var i=!1,n=t.ui.keyCode,r=this._IsRTL();if(this._datepickerShowing())switch(e.keyCode){case 84:e.altKey&&e.ctrlKey&&(this._dpDiv.find(".oj-datepicker-current").focus(),i=!0);break;case n.TAB:break;case n.SPACE:case n.ENTER:var a=t("td."+this._DAYOVER_CLASS,this._dpDiv);return a[0]&&this._selectDay(this._currentMonth,this._currentYear,a[0],e),e.preventDefault(),e.stopPropagation(),!1;case n.ESCAPE:this._hide(this._ON_CLOSE_REASON_CANCELLED),i=!0;break;case n.PAGE_UP:e.ctrlKey&&e.altKey?this._adjustDate(-this.options.datePicker.stepBigMonths,"M",!0):e.altKey?this._adjustDate(-1,"Y",!0):this._adjustDate(-this._getStepMonths(),"M",!0),i=!0;break;case n.PAGE_DOWN:e.ctrlKey&&e.altKey?this._adjustDate(+this.options.datePicker.stepBigMonths,"M",!0):e.altKey?this._adjustDate(1,"Y",!0):this._adjustDate(+this._getStepMonths(),"M",!0),i=!0;break;case n.END:this._currentDay=this._getDaysInMonth(this._currentYear,this._currentMonth),this._changeCurrentDay(),i=!0;break;case n.HOME:this._currentDay=1,this._changeCurrentDay(),i=!0;break;case n.LEFT:e.originalEvent&&e.originalEvent.altKey||e.altKey?this._adjustDate(e.ctrlKey?-this.options.datePicker.stepBigMonths:-this._getStepMonths(),"M",!0):this._adjustDate(r?1:-1,"D",!0),i=!0;break;case n.UP:this._adjustDate(-7,"D",!0),i=!0;break;case n.RIGHT:e.originalEvent&&e.originalEvent.altKey||e.altKey?this._adjustDate(e.ctrlKey?+this.options.datePicker.stepBigMonths:+this._getStepMonths(),"M",!0):this._adjustDate(r?-1:1,"D",!0),i=!0;break;case n.DOWN:this._adjustDate(7,"D",!0),i=!0}i&&(e.preventDefault(),e.stopPropagation())},_changeCurrentDay:function(){var e,i=t("."+this._DAYOVER_CLASS,this._dpDiv),n=this._currentDay+"";if(1===i.length&&i.removeClass(this._DAYOVER_CLASS),e=this._isMultiMonth()?t("table.oj-datepicker-calendar.oj-focus",this._dpDiv):t("table.oj-datepicker-calendar",this._dpDiv),0===(i=t("a.oj-enabled:contains("+this._currentDay+")",e).filter(function(){return t(this).text()===n})).length&&(i=t("span.oj-disabled:contains("+this._currentDay+")",e).filter(function(){return t(this).text()===n})),1===i.length){var r=i.parent();e.addClass("oj-focus-highlight"),e.attr("aria-activedescendant",r.attr("id")+""),r.addClass(this._DAYOVER_CLASS)}},_doMonthViewKeyDown:function(e){var i=!1,n=t.ui.keyCode,r=this._IsRTL();if(this._datepickerShowing())switch(e.keyCode){case 84:e.altKey&&e.ctrlKey&&(this._dpDiv.find(".oj-datepicker-current").focus(),i=!0);break;case n.SPACE:case n.ENTER:var a=t("td."+this._DAYOVER_CLASS,this._dpDiv);return a[0]&&this._selectMonthYear(a[0],"M"),e.preventDefault(),e.stopPropagation(),!1;case n.ESCAPE:this.hide(),i=!0;break;case n.PAGE_UP:e.ctrlKey&&e.altKey?this._adjustDate(-this.options.datePicker.stepBigMonths,"M",!0,"month"):e.altKey?this._adjustDate(-1,"Y",!0,"month"):this._adjustDate(-this._getStepMonths(),"M",!0,"month"),i=!0;break;case n.PAGE_DOWN:e.ctrlKey&&e.altKey?this._adjustDate(+this.options.datePicker.stepBigMonths,"M",!0,"month"):e.altKey?this._adjustDate(1,"Y",!0,"month"):this._adjustDate(+this._getStepMonths(),"M",!0,"month"),i=!0;break;case n.END:this._currentMonth=11,this._updateDatepicker(!0,"month"),i=!0;break;case n.HOME:this._currentMonth=0,this._updateDatepicker(!0,"month"),i=!0;break;case n.LEFT:this._adjustDate(r?1:-1,"M",!0,"month"),i=!0;break;case n.UP:this._adjustDate(-3,"M",!0,"month"),i=!0;break;case n.RIGHT:this._adjustDate(r?-1:1,"M",!0,"month"),i=!0;break;case n.DOWN:this._adjustDate(3,"M",!0,"month"),i=!0}i&&(e.preventDefault(),e.stopPropagation())},_doYearViewKeyDown:function(e){var i=!1,n=t.ui.keyCode,r=this._IsRTL();if(this._datepickerShowing())switch(e.keyCode){case 84:e.altKey&&e.ctrlKey&&(this._dpDiv.find(".oj-datepicker-current").focus(),i=!0);break;case n.SPACE:case n.ENTER:var a=t("td."+this._DAYOVER_CLASS,this._dpDiv);return a[0]&&this._selectMonthYear(a[0],"Y"),e.preventDefault(),e.stopPropagation(),!1;case n.ESCAPE:this.hide(),i=!0;break;case n.PAGE_UP:e.altKey&&this._adjustDate(-1,"Y",!0,"year"),i=!0;break;case n.PAGE_DOWN:e.altKey&&this._adjustDate(1,"Y",!0,"year"),i=!0;break;case n.END:this._currentYear=10*Math.floor(this._currentYear/10)+9,this._updateDatepicker(!0,"year"),i=!0;break;case n.HOME:this._currentYear=10*Math.floor(this._currentYear/10),this._updateDatepicker(!0,"year"),i=!0;break;case n.LEFT:this._adjustDate(r?1:-1,"Y",!0,"year"),i=!0;break;case n.UP:this._adjustDate(-3,"Y",!0,"year"),i=!0;break;case n.RIGHT:this._adjustDate(r?-1:1,"Y",!0,"year"),i=!0;break;case n.DOWN:this._adjustDate(3,"Y",!0,"year"),i=!0}i&&(e.preventDefault(),e.stopPropagation())},_getDatepickerContent:function(){return this._dpDiv?t(this._dpDiv.find(".oj-datepicker-content")[0]):t()},_isDateTimeSwitcher:function(){return this._dateTimeSwitcherActive},_updateDatepicker:function(e,t,i){var r;this._maxRows=4,(r="year"===t?this._generateViewHTML("Y"):"month"===t?this._generateViewHTML("M"):this._generateViewHTML("D")).html="<div"+(this._isDateTimeSwitcher()?"":" class='oj-datepicker-wrapper'")+">"+r.html+"</div>",this._currentView=t;var a=this._getDatepickerContent();if(i){var s=a.children().first();s.css({position:"absolute",left:0,top:0}),a.prepend(r.html);var o=a.children().first(),l="previous"===i?"end":"start";if(!this._animationResolve){var c=n.getContext(this.element[0]).getBusyContext();this._animationResolve=c.addBusyState({description:"The datepicker id='"+this.element.attr("id")+"' is animating."})}_.startAnimation(o[0],"open",{effect:"slideIn",direction:l});var u=_.startAnimation(s[0],"close",{effect:"slideOut",direction:l,persist:"all"}),h=this;u.then(function(){s&&s.remove(),h._setupNewView(e,t,r.dayOverId),h._animationResolve(),h._animationResolve=null})}else a.empty().append(r.html),this._setupNewView(e,t,r.dayOverId)},_setupNewView:function(e,t,i){this._attachHandlers(),i&&this._dpDiv.find(".oj-datepicker-calendar").attr("aria-activedescendant",i);var n=this._getNumberOfMonths(),r=n[1],a=275;if(this._dpDiv.removeClass("oj-datepicker-multi-2 oj-datepicker-multi-3 oj-datepicker-multi-4").width(""),"year"===t||"month"===t)this._dpDiv.removeClass("oj-datepicker-multi");else{if((r=(n=this._getNumberOfMonths())[1])>1){var s=this._dpDiv.find(".oj-datepicker-calendar"),o=s.find("tbody a"),l=parseFloat(o.css("width")),c=parseFloat(s.css("margin-left"));isNaN(l)||isNaN(c)||(a=l*("number"===this.options.datePicker.weekDisplay?8:7)+2*c),this._dpDiv.addClass("oj-datepicker-multi-"+r).css("width",a*r+(this._isInLine?2:0)+"px")}this._dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("oj-datepicker-multi")}this._datepickerShowing()&&this.element.is(":visible")&&!this.element.is(":disabled")&&(e?this._placeFocusOnCalendar():this._isInLine||this.element[0]===document.activeElement||this.element.focus())},_placeFocusOnCalendar:function(){var e=this._dpDiv.find(".oj-datepicker-calendar");e[0]&&e[0]!==document.activeElement&&e[0].focus()},_adjustDate:function(e,t,i,n,r){if(!this._IsDisabled()){var a=this._currentMonth,s=this._currentYear;this._adjustInstDate(e+("M"===t?this.options.datePicker.currentMonthPos:0),t),"D"===t&&a===this._currentMonth&&s===this._currentYear?this._changeCurrentDay():this._updateDatepicker(i,n,r)}},_gotoToday:function(){var e=new Date,t=this._GetConverter(),i=t.resolvedOptions();if(void 0!==i.timeZone&&"local"!==i.isoStrFormat){var n=t.parse(e.toISOString());e=u.IntlConverterUtils.isoToLocalDate(n)}this._currentDay=e.getDate(),this._currentMonth=e.getMonth(),this._drawMonth=this._currentMonth,this._currentYear=e.getFullYear(),this._drawYear=this._currentYear,this._adjustDate(null,null,!0,"day")},_selectMonthYear:function(e,i){var n,r=this._getDateIso(),a=e.getAttribute("data-year"),s="";a&&(n=parseInt(a,10),this._currentYear=n,this._drawYear=n,s=n+"_"),"M"===i?(n=parseInt(e.getAttribute("data-month"),10),this._currentMonth=n,this._drawMonth=n,s=n+"_",r=this._validateDatetime(r,{fullYear:this._currentYear,month:this._currentMonth})):r=this._validateDatetime(r,{fullYear:this._currentYear}),t("#"+this._GetSubId(s+this._CALENDAR_DESCRIPTION_ID)).html(this._EscapeXSS(this.options.monthWide[this._drawMonth])+" "+T(this._drawYear,this._drawMonth)),this._adjustDate(0,0,!0,"M"===i?"day":this._toYearFromView)},_selectDay:function(e,i,n,r){if(!t(n).hasClass(this._UNSELECTABLE_CLASS)&&!this._IsDisabled()){this._isDateTimeSwitcher()||this._hide(this._ON_CLOSE_REASON_SELECTION),this._currentDay=t("a",n).html(),this._currentMonth=e,this._currentYear=i;var a=u.IntlConverterUtils,s=this.options.value,o=new Date(this._currentYear,this._currentMonth,this._currentDay);if(s)try{s=a._dateTime(s,{fullYear:o.getFullYear(),month:o.getMonth(),date:o.getDate()})}catch(e){m.info("The value of the InputDateTime element should be an ISOString, please use a valid ISOString"),s=a.dateToLocalIso(o)}else s=a.dateToLocalIso(o);this._setDisplayAndValue(s,{}),this._isDateTimeSwitcher()&&this._placeFocusOnCalendar()}},_setDisplayAndValue:function(e,t){if(this._isDateTimeSwitcher()){if(this._switcherDateValue=e,this._setCurrentDate(e),this._datepickerShowing()){var i=!(this._isInLine&&!this._dpDiv[0].contains(document.activeElement));this._updateDatepicker(i)}}else{var n=this._GetConverter().format(e);this._SetDisplayValue(n),this._SetValue(n,t)}},_getDefaultIsoDate:function(){return u.IntlConverterUtils.dateToLocalIso(this._getTodayDate())},_setCurrentDate:function(e){var t;t=this._validateDatetime(e||this._getDefaultIsoDate(),["fullYear","month","date"],!0),this._currentDay=t.date,this._currentMonth=t.month,this._isMultiMonth()||(this._drawMonth=t.month),this._currentYear=t.fullYear,this._drawYear=this._currentYear,this._adjustInstDate()},_getStepMonths:function(){var e=this.options.datePicker.stepMonths;return t.isNumeric(e)?e:this.options.datePicker.numberOfMonths},_isButtonActivated:function(e){return!this._IsDisabled()&&("click"===e.type||"keydown"===e.type&&(32===e.keyCode||13===e.keyCode))},_gotoPrev:function(e){"year"===this._currentView?this._adjustDate(-10,"Y",!0,"year","previous"):"month"===this._currentView?this._adjustDate(-1,"Y",!0,"month","previous"):this._adjustDate(-e,"M",!0,"day","previous")},_gotoNext:function(e){"year"===this._currentView?this._adjustDate(10,"Y",!0,"year","next"):"month"===this._currentView?this._adjustDate(1,"Y",!0,"month","next"):this._adjustDate(+e,"M",!0,"day","next")},_attachHandlers:function(){var i=this._getStepMonths(),n=this,r=function(e){var i=!1;return"keydown"===e.type&&e.keyCode===t.ui.keyCode.TAB&&(i=!0),i};this._dpDiv.find("[data-handler]").map(function(){var e={prev:function(e){return n._isButtonActivated(e)&&n._gotoPrev(i),r(e)},next:function(e){return n._isButtonActivated(e)&&n._gotoNext(i),r(e)},today:function(e){return n._isButtonActivated(e)&&n._gotoToday(),r(e)},selectDay:function(e){return n._isButtonActivated(e)&&n._selectDay(+this.getAttribute("data-month"),+this.getAttribute("data-year"),this,e),r(e)},selectMonth:function(e){return n._isButtonActivated(e)&&n._selectMonthYear(this,"M"),r(e)},selectYear:function(e){return n._isButtonActivated(e)&&n._selectMonthYear(this,"Y"),r(e)},calendarKey:function(e){"year"===n._currentView?n._doYearViewKeyDown(e):"month"===n._currentView?n._doMonthViewKeyDown(e):n._doCalendarKeyDown(e)},selectMonthHeader:function(e){return n._isButtonActivated(e)&&("month"===n._currentView?n._updateDatepicker(!0,"day"):n._updateDatepicker(!0,"month")),r(e)},selectYearHeader:function(e){return n._isButtonActivated(e)&&("year"===n._currentView?n._updateDatepicker(!0,"day"):(n._toYearFromView=n._currentView,n._updateDatepicker(!0,"year"))),r(e)}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])}),this._dpDiv.find(".oj-datepicker-calendar").map(function(){e.DomUtils.makeFocusable({element:t(this),applyHighlight:!0})});var a=this._dpDiv.find(".oj-datepicker-header a, .oj-datepicker-buttonpane a");this._AddHoverable(a),this._AddActiveable(a)},_registerSwipeHandler:function(){if(e.DomUtils.isTouchSupported()){var t=this,n=this._getStepMonths(),r=this._IsRTL(),a={recognizers:[[i.Swipe,{direction:i.DIRECTION_HORIZONTAL}]]};this._dpDiv.ojHammer(a).on(r?"swiperight":"swipeleft",function(){return t._gotoNext(n),!1}).on(r?"swipeleft":"swiperight",function(){return t._gotoPrev(n),!1})}},_getMinMaxDateIso:function(e){var t=this.options[e];if(t){var i=this._getDateIso();t=u.IntlConverterUtils._minMaxIsoString(t,i)}return t},_generateHeader:function(e,t,i,n,r){var a=this._IsRTL(),s=this._EscapeXSS(this.getTranslatedString("prevText")),o=n?"<a role='button' href='#' onclick='return false;' class='oj-datepicker-prev-icon oj-enabled oj-default oj-component-icon oj-clickable-icon-nocontext' data-handler='prev' data-event='click keydown' aria-label='"+s+"'></a>":"<a class='oj-datepicker-prev-icon oj-disabled oj-component-icon oj-clickable-icon-nocontext' title='"+s+"'></a>",l=this._EscapeXSS(this.getTranslatedString("nextText")),c=r?"<a role='button' href='#' onclick='return false;' class='oj-datepicker-next-icon oj-enabled oj-default oj-component-icon oj-clickable-icon-nocontext' data-handler='next' data-event='click keydown' aria-label='"+l+"'></a>":"<a class='oj-datepicker-next-icon oj-disabled oj-component-icon oj-clickable-icon-nocontext' title='"+l+"'></a>",u="<div class='oj-datepicker-header"+(this._IsDisabled()?" oj-disabled ":" oj-enabled oj-default ")+"'>";return/all|left/.test(i)&&(u+=a?c:o),/all|right/.test(i)&&(u+=a?o:c),u+=this._generateMonthYearHeader(e,t),u+="</div>"},_generateFooter:function(e,t){var i="",n=this._EscapeXSS(this.getTranslatedString("currentText")),r="<a role='button' href='#' onclick='return false;' class='oj-datepicker-current oj-priority-secondary "+(this._IsDisabled()?"oj-disabled' disabled":"oj-enabled'")+" data-handler='today' data-event='click keydown'>"+n+"</a>";if(e.length>1){var a=0,s=[{index:e.indexOf("today"),content:this._isInRange(t)?r:""}];for(s.sort(function(e,t){return e.index-t.index});a<s.length&&s[a].index<0;)a+=1;for(;a<s.length;)i+=s[a].content,a+=1;i.length>0&&(i="<div class='oj-datepicker-buttonpane'>"+i+"</div>")}return i},_isMultiMonth:function(){var e=this._getNumberOfMonths();return 1!==e[0]||1!==e[1]},_generateViewHTML:function(e){var t,i,n,r=u.IntlConverterUtils,a=["date","month","fullYear"],s=this._GetConverter(),o=new Date,l=new Date(o.getFullYear(),o.getMonth(),o.getDate()),c=this._IsRTL(),h=this.options.datePicker.footerLayout,d=this._getNumberOfMonths(),p=this.options.datePicker.currentMonthPos,_=this._isMultiMonth(),v=this._getMinMaxDateIso("min"),f=this._getMinMaxDateIso("max"),g=this._drawMonth-p,y=this._drawYear,D=new Date(this._currentYear,this._currentMonth,this._currentDay);n=s instanceof Promise?this._getDateIso():s.parse(this._getDateIso());var k=this._validateDatetime(n,a,!0),b=k.fullYear,S=k.date,C=k.month,w=new Date(b,C,S),I=this._IsDisabled(),j=this._EscapeXSS(this.getTranslatedString("weekText"));v&&(s instanceof Promise||(v=s.parse(v),t=this._validateDatetime(v,a,!0))),f&&(s instanceof Promise||(f=s.parse(f),i=this._validateDatetime(f,a,!0)));try{n=r._clearTime(n)}catch(e){m.info("The value of the InputDateTime element should be an ISOString, please use a valid ISOString"),n=r._clearTime(this._getDefaultIsoDate())}if(g<0&&(g+=12,y-=1),t){var E=new Date(t.fullYear,t.month,t.date);for(i&&s.compareISODates(f,v)<0&&(E=new Date(i.fullYear,i.month,i.date));new Date(y,g,this._getDaysInMonth(y,g))<E;)(g+=1)>11&&(g=0,y+=1)}if(i){var P=new Date(i.fullYear,i.month-d[0]*d[1]+1,i.date);for(t&&s.compareISODates(f,v)<0&&(P=new Date(t.fullYear,t.month,t.date));new Date(y,g,1)>P;)(g-=1)<0&&(g=11,y-=1)}this._drawMonth=g,this._drawYear=y;var O=this._generateFooter(h,l),T=this.options.datePicker.weekDisplay;return"D"===e?this._generateDayHTMLContent(r,O,T,l,c,d,_,t,i,g,y,D,k,b,S,C,w,I,j):"M"===e?this._generateMonthHTMLContent(O,t,i,g,y,w,I):this._generateYearHTMLContent(r,O,t,i,g,y,w,I)},_generateDayHTMLContent:function(e,t,i,n,r,a,s,o,l,c,u,h,d,p,_,v,f,g,y){for(var D,k=this.options.dayWide,b=this.options.dayNarrow,S=this.options.firstDayOfWeek,C="",w=this.options.dayFormatter,I=null,j=this._canAdjustMonth(-1,u,c)&&!g,E=this._canAdjustMonth(1,u,c)&&!g,P=this.options.datePicker.daysOutsideMonth,O="",T="all",A=0;A<a[0];A++){var M="";this._maxRows=3;for(var L=0;L<a[1];L++){T=0===A?"all":"";var N="";if(s){if(N+="<div class='oj-datepicker-group",a[1]>1)switch(L){case 0:N+=" oj-datepicker-group-first",T=0===A?r?"right":"left":"";break;case a[1]-1:N+=" oj-datepicker-group-last",T=0===A?r?"left":"right":"";break;default:N+=" oj-datepicker-group-middle",T=""}N+="'>"}N+=this._generateHeader(c,u,T,j,E),N+="<table class='oj-datepicker-calendar"+("number"===i?" oj-datepicker-weekdisplay":"")+(g?" oj-disabled ":" oj-enabled oj-default ")+"' tabindex=-1 data-handler='calendarKey' data-event='keydown' aria-readonly='true' role='grid' aria-labelledby='"+this._GetSubId(u+"_"+c+"_"+this._CALENDAR_DESCRIPTION_ID)+"'><thead role='presentation'><tr role='row'>";var R="number"===i?"<th class='oj-datepicker-week-col'>"+this._EscapeXSS(this.getTranslatedString("weekHeader"))+"</th>":"";for(D=0;D<7;D++){var x=(D+parseInt(S,10))%7;R+="<th role='columnheader' aria-label='"+k[x]+"'"+((D+S+6)%7>=5?" class='oj-datepicker-week-end'":"")+"><span title='"+k[x]+"' aria-hidden = 'true'>"+b[x]+"</span></th>"}N+=R+"</tr></thead><tbody role='presentation'>";var V=this._getDaysInMonth(u,c);u===p&&c===v&&(_=Math.min(_,V));var Y=(this._getFirstDayOfMonth(u,c)-S+7)%7,G=Math.ceil((Y+V)/7),B=s&&this._maxRows>G?this._maxRows:G;this._maxRows=B;for(var F=new Date(u,c,1-Y),U=0;U<B;U++){N+="<tr role='row'>";var H=" ";try{var W=this._GetConverter();W&&W.calculateWeek&&(H=this._GetConverter().calculateWeek(e.dateToLocalIso(F)))}catch(e){m.info("The value of the InputDateTime element should be an ISOString, please use a valid ISOString")}var K="none"===i?"":"<td class='oj-datepicker-week-col' role='rowheader' aria-label='"+y+" "+H+"'>"+H+"</td>";for(D=0;D<7;D++){var z,X=F.getMonth()!==c,q=F.getTime()===f.getTime(),J="oj-dp-"+this.uuid+"-"+U+"-"+D+"-"+A+"-"+L,Z=F.getTime()===h.getTime()&&c===this._currentMonth;Z?(C=J,z=" "+this._DAYOVER_CLASS):z="";var $=[!0,""],Q=F.getFullYear(),ee=F.getMonth(),te=F.getDate();w&&(I=w({fullYear:Q,month:ee+1,date:te}))&&($=[!I.disabled,I.className||""],I.tooltip&&$.push(I.tooltip));var ie=F.getTime()===f.getTime(),ne=X&&"selectable"!==P||!$[0]||this._outSideMinMaxRange(F,o,l);K+="<td role='gridcell' aria-disabled='"+!!ne+"' aria-selected='"+q+"' id='"+J+"' class='"+((D+S+6)%7>=5?" oj-datepicker-week-end":"")+(X?" oj-datepicker-other-month":"")+z+(ne||g?" "+this._UNSELECTABLE_CLASS+" oj-disabled":" oj-enabled ")+(X&&"hidden"===P?"":" "+$[1]+(q?" "+this._CURRENT_CLASS:"")+(F.getTime()===n.getTime()?" oj-datepicker-today":""))+"'"+(X&&"hidden"===P||!$[2]?"":" title='"+$[2].replace(/'/g,"&#39;")+"'")+(ne?"":" data-handler='selectDay' data-event='click' data-month='"+F.getMonth()+"' data-year='"+F.getFullYear()+"'")+">"+(X&&"hidden"===P?"&#xa0;":ne||g?"<span class='oj-disabled'>"+F.getDate()+"</span>":"<a role='button' class='oj-enabled"+(ie?" oj-selected":"")+(X?" oj-priority-secondary":"")+"' "+(Z?"":"tabindex='-1' ")+" onclick='return false;' href='#'>"+F.getDate()+"</a>")+"</td>",F.setDate(F.getDate()+1)}N+=K+"</tr>"}(c+=1)>11&&(c=0,u+=1),N+="</tbody></table>",s&&(N+="</div>",a[0]>0&&L===a[1]-1&&(N+="<div class='oj-datepicker-row-break'></div>")),M+=N}O+=M}return{html:O+=t,dayOverId:C}},_generateMonthYearHeader:function(e,t){var i=this.options.datePicker.changeMonth,n=this.options.datePicker.changeYear,r=l.isMonthPriorToYear()?"before":"after",a="<div class='oj-datepicker-title'>",s="",o=this.options.monthWide,c=this._IsDisabled(),u=t+"_"+e+"_";o&&("none"===i?s+="<span class='oj-datepicker-month'>"+o[e]+"</span>":(s+="<a role='button' onclick='return false;' href='#' data-handler='selectMonthHeader' data-event='click keydown' class='oj-datepicker-month "+(c?"oj-disabled' disabled":"oj-enabled'")+">",s+=o[e]+"</a>"),"before"===r&&(a+=s+("select"!==i||"select"!==n?"&#xa0;":""))),this.yearshtml||(this.yearshtml="","none"===n?a+="<span class='oj-datepicker-year'>"+T(t,e)+"</span>":(a+="<a role='button' onclick='return false;' href='#' data-handler='selectYearHeader' data-event='click keydown' class='oj-datepicker-year "+(c?"oj-disabled' disabled":"oj-enabled'")+">",a+=T(t,e)+"</a>",this.yearshtml=null)),o&&"after"===r&&(a+=("select"!==i||"select"!==n?"&#xa0;":"")+s);var h=this._drawYear===t&&this._drawMonth===e;return h&&(a+="<span aria-hidden='true' class='oj-helper-hidden-accessible' id='"+this._GetSubId(this._DATEPICKER_DIALOG_DESCRIPTION_ID)+"'>",a+=this._EscapeXSS(this.getTranslatedString("picker"))+"</span>"),a+="<span aria-hidden='true' class='oj-helper-hidden-accessible' id='"+this._GetSubId(u+this._CALENDAR_DESCRIPTION_ID)+"'>",a+=(o?o[e]+" ":"")+T(t,e)+"</span>",h&&(a+="<span aria-hidden='true' class='oj-helper-hidden-accessible' id='"+this._GetSubId(this._DATEPICKER_DESCRIPTION_ID)+"'>"+this._EscapeXSS(this.getTranslatedString("datePicker"))+"</span>"),a+="</div>"},_adjustInstDate:function(e,t){var i=this._drawYear+("Y"===t?e:0),n=this._drawMonth+("M"===t?e:0),r=Math.min(this._currentDay,this._getDaysInMonth(i,n))+("D"===t?e:0),a=new Date(i,n,r);this._currentDay=a.getDate(),this._currentMonth=a.getMonth(),this._drawMonth=this._currentMonth,this._currentYear=a.getFullYear(),this._drawYear=this._currentYear},_generateMonthHTMLContent:function(e,t,i,n,r,a,s){var o=this.options.monthAbbreviated,l="",c=this._canAdjustYear(-1,r)&&!s,u=this._canAdjustYear(1,r)&&!s,h="";this._maxRows=3;var d="";d+=this._generateHeader(n,r,"all",c,u),d+="<table class='oj-datepicker-calendar oj-datepicker-monthview"+(s?" oj-disabled ":" oj-enabled oj-default ")+"' tabindex=-1 data-handler='calendarKey' data-event='keydown' aria-readonly='true' role='grid' aria-labelledby='"+this._GetSubId(r+"_"+n+"_"+this._CALENDAR_DESCRIPTION_ID)+"'>",d+="<tbody role='presentation'>";for(var p=new Date(r,0,1),_=0;_<3;_++){d+="<tr role='row'>";for(var m="",v=0;v<4;v++){var f,g=4*_+v,y=p.getMonth()===a.getMonth(),D="oj-dp-"+this.uuid+"-"+_+"-"+v+"-0-0",k=g===this._currentMonth;k?(l=D,f=" "+this._DAYOVER_CLASS):f="";var b=p.getMonth()===a.getMonth(),S=t&&t.fullYear===r,C=i&&i.fullYear===r,w=!((!S||g>=t.month)&&(!C||g<=i.month));m+="<td role='gridcell' aria-disabled='"+!!w+"' aria-selected='"+y+"' id='"+D+"' class='"+f+(w||s?" "+this._UNSELECTABLE_CLASS+" oj-disabled":" oj-enabled ")+(y?" "+this._CURRENT_CLASS:"")+"'"+(w?"":" data-handler='selectMonth' data-event='click' data-month='"+p.getMonth()+"' data-year='"+p.getFullYear()+"'")+">"+(w||s?"<span class='oj-disabled'>"+o[g]+"</span>":"<a role='button' class='oj-enabled"+(b?" oj-selected":"")+"' "+(k?"":"tabindex='-1' ")+" onclick='return false;' href='#'>"+o[g]+"</a>")+"</td>",p.setMonth(p.getMonth()+1)}d+=m+"</tr>"}return h+=d+="</tbody></table>",{html:h+=e,dayOverId:l}},_generateYearHTMLContent:function(e,t,i,n,r,a,s,o){var l="",c=this._canAdjustDecade(-1,a)&&!o,u=this._canAdjustDecade(1,a)&&!o,h="";this._maxRows=3;var d="";d+=this._generateHeader(r,a,"all",c,u),d+="<table class='oj-datepicker-calendar oj-datepicker-yearview"+(o?" oj-disabled ":" oj-enabled oj-default ")+"' tabindex=-1 data-handler='calendarKey' data-event='keydown' aria-readonly='true' role='grid' aria-labelledby='"+this._GetSubId(a+"_"+r+"_"+this._CALENDAR_DESCRIPTION_ID)+"'>",d+="<tbody role='presentation'>";for(var p=this._getYearRange(a,i,n),_=10*Math.floor(a/10),m=new Date(_,r,1),v=0;v<3;v++){d+="<tr role='row'>";for(var f="",g=0;g<4&&(4!==v||1!==g);g++){var y,D=_+4*v+g,k=m.getFullYear()===s.getFullYear(),b="oj-dp-"+this.uuid+"-"+v+"-"+g+"-0-0",S=D===this._currentYear;S?(l=b,y=" "+this._DAYOVER_CLASS):y="";var C=m.getFullYear()===s.getFullYear(),w=T(D,r),I=D<p.startYear||D>p.endYear;f+="<td role='gridcell' aria-disabled='"+!!I+"' aria-selected='"+k+"' id='"+b+"' class='"+y+(I||o?" "+this._UNSELECTABLE_CLASS+" oj-disabled":" oj-enabled ")+(k?" "+this._CURRENT_CLASS:"")+"'"+(I?"":" data-handler='selectYear' data-event='click' data-month='"+m.getMonth()+"' data-year='"+m.getFullYear()+"'")+">"+(I||o?"<span class='oj-disabled'>"+w+"</span>":"<a role='button' class='oj-enabled"+(C?" oj-selected":"")+"' "+(S?"":"tabindex='-1' ")+" onclick='return false;' href='#'>"+w+"</a>")+"</td>",m.setFullYear(m.getFullYear()+1)}d+=f+"</tr>"}return h+=d+="</tbody></table>",{html:h+=t,dayOverId:l}},_getYearRange:function(e,t,i){var n=this.options.datePicker.yearRange.split(":"),r=(new Date).getFullYear();function a(t){var i;return i=t.match(/c[+-].*/)?e+parseInt(t.substring(1),10):t.match(/[+-].*/)?r+parseInt(t,10):parseInt(t,10),isNaN(i)?r:i}var s=a(n[0]),o=Math.max(s,a(n[1]||""));return{startYear:s=t?Math.max(s,t.fullYear):s,endYear:o=i?Math.min(o,i.fullYear):o}},_getNumberOfMonths:function(){var e=this.options.datePicker.numberOfMonths;return null==(e="string"==typeof e?parseInt(e,10):e)?[1,1]:"number"==typeof e?[1,e]:e},_getDaysInMonth:function(e,t){return 32-new Date(e,t,32).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i){var n=this._getNumberOfMonths(),r=new Date(t,i+(e<0?e:n[0]*n[1]),1);return e<0&&r.setDate(this._getDaysInMonth(r.getFullYear(),r.getMonth())),this._isInRange(r)},_canAdjustYear:function(e,t){var i;return e<0?(i=new Date(t+e,12,1)).setDate(this._getDaysInMonth(i.getFullYear(),i.getMonth())):i=new Date(t+e,1,1),this._isInRange(i)},_canAdjustDecade:function(e,t){var i,n=10*Math.floor(t/10);return e<0?(i=new Date(n+9+10*e,12,1)).setDate(this._getDaysInMonth(i.getFullYear(),i.getMonth())):i=new Date(n+10*e,1,1),this._isInRange(i)},_outSideMinMaxRange:function(e,t,i){var n=t?new Date(t.fullYear,t.month,t.date):null,r=i?new Date(i.fullYear,i.month,i.date):null;return null!==n&&e<n||null!==r&&e>r},_isInRange:function(e){var t,i,n=this._GetConverter(),r=this._getMinMaxDateIso("min"),a=null,s=this._getMinMaxDateIso("max"),o=null,l=this.options.datePicker.yearRange;if(l){var c=l.split(":"),u=(new Date).getFullYear();a=parseInt(c[0],10),o=parseInt(c[1],10),c[0].match(/[+-].*/)&&(a+=u),c[1].match(/[+-].*/)&&(o+=u)}if(r){r=n.parse(r);var h=this._validateDatetime(r,["fullYear","month","date"],!0);t=new Date(h.fullYear,h.month,h.date)}if(s){s=n.parse(s);var d=this._validateDatetime(s,["fullYear","month","date"],!0);i=new Date(d.fullYear,d.month,d.date)}return(!t||e.getTime()>=t.getTime())&&(!i||e.getTime()<=i.getTime())&&(!a||e.getFullYear()>=a)&&(!o||e.getFullYear()<=o)},_GetCalendarTitle:function(){return this._EscapeXSS(this.getTranslatedString("tooltipCalendar"+(this._IsDisabled()?"Disabled":"")))},_disableEnable:function(e){this._triggerNode&&(I(this._triggerNode[0].children,e),this._triggerNode.find("."+this._TRIGGER_CALENDAR_CLASS).attr("title",this._GetCalendarTitle())),e&&this._hide(this._ON_CLOSE_REASON_CLOSE),this._isInLine&&this._updateDatepicker()},_AppendInputHelper:function(){this._isInLine||!0===this.options.readOnly||this._superApply(arguments)},_onBlurHandler:function(e){this._isInLine||this._superApply(arguments)},_onKeyDownHandler:function(i){if(!this._isInLine){this._superApply(arguments);var n=t.ui.keyCode,r=!1;if(this._datepickerShowing())switch(i.keyCode){case n.TAB:this._hide(this._ON_CLOSE_REASON_TAB);break;case n.ESCAPE:this._hide(this._ON_CLOSE_REASON_CANCELLED),r=!0;break;case n.UP:case n.DOWN:var a=this._dpDiv.find(".oj-datepicker-calendar")[0];e.FocusUtils.focusFirstTabStop(a)||a.focus(),r=!0}else switch(i.keyCode){case n.UP:case n.DOWN:this._SetValue(this._GetDisplayValue(),i),this.show(),r=!0}return r?(i.preventDefault(),i.stopPropagation(),!1):void 0}},_SetDisplayValue:function(e){if(this._isInLine||this._superApply(arguments),this._setCurrentDate(this._getDateIso()),this._datepickerShowing()){var t=!(this._isInLine&&!this._dpDiv[0].contains(document.activeElement));this._updateDatepicker(t)}},_ResetAllValidators:function(){this._datePickerDefaultValidators={},this._superApply(arguments)},_GetConverter:function(){if(this.options.converter)return this._superApply(arguments);var e=this._GetDefaultConverter();return this.option("converter",e,{_context:{writeback:!0,internalSet:!0}}),e},_GetElementValue:function(){return this.options.value||""},_GetDefaultStyleClass:function(){return"oj-inputdate"},_GetImplicitValidators:function(){var e=this._superApply(arguments);if(null!=this.options.min||null!=this.options.max){var t=C(this.options,this._GetConverter(),this._GetDefaultStyleClass());this._datePickerDefaultValidators.dateTimeRange=t}if(null!=this.options.dayFormatter){var i=w(this.options,this._GetConverter());this._datePickerDefaultValidators.dateRestriction=i}return Object.assign(this._datePickerDefaultValidators,e)},_NotifyDetached:function(){this._hide(this._ON_CLOSE_REASON_CLOSE),this._superApply(arguments)},_NotifyHidden:function(){this._hide(this._ON_CLOSE_REASON_CLOSE),this._superApply(arguments)},_createDateTimeRangeValidator:function(e){var t=this.options,i=this._GetDefaultStyleClass(),n=function(e){return this._dateTimeRangeValidator=C(t,e,i),this._dateTimeRangeValidator}.bind(this);return e instanceof Promise?e.then(function(e){return n(e)}):n(e)},_getDateTimeRangeValidator:function(){return this._dateTimeRangeValidator},_createDateRestrictionValidator:function(e){var t=function(e){return this._dateRestrictionValidator=w(this.options,e),this._dateRestrictionValidator}.bind(this);return e instanceof Promise?e.then(function(e){return t(e)}):t(e)},_getDateRestrictionValidator:function(){return this._dateRestrictionValidator},_getValidator:function(e){var t=null;return"min"===e||"max"===e?t=this._getDateTimeRangeValidator():"dayFormatter"===e&&(t=this._getDateRestrictionValidator()),t},_getTodayDate:function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},_getDateIso:function(){return this._isDateTimeSwitcher()&&this._switcherDateValue?this._switcherDateValue:this.options.value||this._getDefaultIsoDate()},getNodeBySubId:function(e){var i=null,n=e&&e.subId,r=this._dpDiv,a=this._getDatepickerContent();if(n)switch(n){case"oj-datepicker-content":i=a[0];break;case"oj-inputdatetime-calendar-icon":i=t(".oj-inputdatetime-calendar-icon",this._triggerNode)[0];break;case"oj-datepicker-prev-icon":i=t(".oj-datepicker-prev-icon",r)[0];break;case"oj-datepicker-next-icon":i=t(".oj-datepicker-next-icon",r)[0];break;case"oj-datepicker-month":i=t(".oj-datepicker-month",r)[0];break;case"oj-datepicker-year":i=t(".oj-datepicker-year",r)[0];break;case"oj-datepicker-current":i=t(".oj-datepicker-current",r)[0];break;case"oj-inputdatetime-date-input":i=this._isInLine?null:this.element[0];break;default:i=null}return i||this._superApply(arguments)},getSubIdByNode:function(e){var i=this._dpDiv,n=null,r=[{selector:".oj-inputdatetime-calendar-icon",ele:this._triggerNode},{selector:".oj-datepicker-prev-icon",ele:i},{selector:".oj-datepicker-next-icon",ele:i},{selector:".oj-datepicker-month",ele:i},{selector:".oj-datepicker-year",ele:i},{selector:".oj-datepicker-current",ele:i}];if(e===i[0])return"oj-datepicker-content";if(!this._isInLine&&e===this.element[0])return"oj-inputdatetime-date-input";for(var a=0,s=r.length;a<s;a++){var o=r[a],l=t(o.selector,o.ele);if(1===l.length&&l[0]===e){n=o.selector.substr(1);break}}return n||this._superApply(arguments)},hide:function(){return this._hide(this._ON_CLOSE_REASON_CLOSE)},_hide:function(e){return P(this)||!this._datepickerShowing()||this._isInLine||(this._popUpDpDiv.ojPopup("close"),this._onClose(e)),this},_onClose:function(e){this._isMobile&&"focus"===this.options.datePicker.showOn?this._inputContainer.focus():("focus"===this.options.datePicker.showOn&&(this._ignoreShow=!0),this.element.focus())},refresh:function(){return this._triggerNode&&this._triggerNode.find("."+this._TRIGGER_CALENDAR_CLASS).attr("title",this._GetCalendarTitle()),this._superApply(arguments)||this},show:function(){if(!(this._datepickerShowing()||this._IsDisabled()||this.options.readOnly))if(this._ignoreShow)this._ignoreShow=!1;else if(P(this)){this.element.blur();var e={};e.date=b(this._getNativeDatePickerConverter(),this._getDateIso()),e.mode="date",this._ShowNativeDatePicker(e)}else this._ShowHTMLDatePicker()},_createNativeDatePickerConverter:function(e){if(null===this._nativePickerConverter){var i=e.resolvedOptions(),n={};t.extend(n,i,{isoStrFormat:"offset"}),this._nativePickerConverter=new h.IntlDateTimeConverter(n)}},_getNativeDatePickerConverter:function(){if(null===this._nativePickerConverter){var e=this._GetConverter().resolvedOptions(),i={};t.extend(i,e,{isoStrFormat:"offset"}),this._nativePickerConverter=new h.IntlDateTimeConverter(i)}return this._nativePickerConverter},_ShowNativeDatePicker:function(e){var i=this._getMinMaxDateIso("min"),n=this._getMinMaxDateIso("max"),r=this._getNativeDatePickerConverter();i&&(e.minDate=b(r,i).valueOf()),n&&(e.maxDate=b(r,n).valueOf());var a=this;a._nativePickerShowing=!0,window.datePicker.show(e,t.proxy(this._OnDatePicked,this),function(e){a._nativePickerShowing=!1,e.startsWith("cancel")?a._onClose(a._ON_CLOSE_REASON_CANCELLED):m.error("Error: native date or time picker failed: "+e)})},_OnDatePicked:function(e){if(this._nativePickerShowing=!1,e){var t=this._validateDatetime(this._getDateIso(),{month:e.getMonth(),date:e.getDate(),fullYear:e.getFullYear()}),i=this._GetConverter().format(t);this._SetValue(i,{})}this._onClose(this._ON_CLOSE_REASON_SELECTION)},_validateDatetime:function(e,t,i){var n;try{n=u.IntlConverterUtils._dateTime(e,t,i)}catch(e){m.info("The value of the InputDate element should be an ISOString, please use a valid ISOString"),n=u.IntlConverterUtils._dateTime(this._getDefaultIsoDate(),t,i)}return n},_ShowHTMLDatePicker:function(){var t=this._IsRTL(),i=this._GetConverter();if(i instanceof Promise?this._switcherPrevValue=this._getDateIso():this._switcherPrevValue=i.parse(this._getDateIso()),this._switcherPrevDay=this._currentDay,this._switcherPrevMonth=this._currentMonth,this._switcherPrevYear=this._currentYear,this._getDatepickerContent().empty(),this._updateDatepicker(),k()){var n=e.PositionUtils.normalizeHorizontalAlignment({my:"start top",at:"start bottom",of:this.element,collision:"flipfit"},t);this._popUpDpDiv.ojPopup("open",this._labelValueWrapper.parentNode,n)}else this._popUpDpDiv.ojPopup("open",this._labelValueWrapper.parentNode,{my:{horizontal:"center",vertical:"bottom"},at:{horizontal:"center",vertical:"bottom"},of:window,collision:"flipfit"}),this._dpDiv.find(".oj-datepicker-calendar").focus();return this}}),a.setDefaultOptions({ojInputDate:{firstDayOfWeek:a.createDynamicPropertyGetter(function(){return l.getFirstDayOfWeek()}),dayWide:a.createDynamicPropertyGetter(function(){return l.getDayNames("wide")}),dayNarrow:a.createDynamicPropertyGetter(function(){return l.getDayNames("narrow")}),monthWide:a.createDynamicPropertyGetter(function(){return l.getMonthNames("wide")}),monthAbbreviated:a.createDynamicPropertyGetter(function(){return l.getMonthNames("abbreviated")}),datePicker:a.createDynamicPropertyGetter(function(){return(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).datePicker}),renderMode:a.createDynamicPropertyGetter(function(){return(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).renderMode}),keyboardEdit:a.createDynamicPropertyGetter(function(){return(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).keyboardEdit})}});var A=(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).showPickerOnDesktop||"disabled";function M(e){var t=e.split(":");if(4!==t.length)throw new Error("timeIncrement value should be in the format of hh:mm:ss:SSS");for(var i={hourIncr:parseInt(t[0].substring(0),10),minuteIncr:parseInt(t[1],10),secondIncr:parseInt(t[2],10),millisecondIncr:parseInt(t[3],10)},n=0,r=Object.keys(i),a=0;a<r.length;a++){n+=i[r[a]]}if(0===n)throw new Error("timeIncrement must have a non 00:00:00:000 value");return i}function L(e,i){for(var n=e.resolvedOptions(),r={},a=["hour","hour12","minute","second","millisecond","timeFormat","timeZone","timeZoneName","isoStrFormat","dst"],s=0,o=a.length;s<o;s++)a[s]in n&&("timeFormat"===a[s]&&(r.formatType="time"),r[a[s]]=n[a[s]]);var l={};if(t.extend(l,r),delete l.isoStrFormat,delete l.dst,t.isEmptyObject(l))throw new Error("Empty object for creating a time picker converter");return t.extend(r,i||{}),new h.IntlDateTimeConverter(r)}function N(e,n,r){var a,s,o,l,c,u=7,h=2,d=[.152,.362,.638,.848],p=.007,_=8,m=38,v=40,f=e,g=[],y=!n&&"oj-timepicker-meridian"===r;!function(){(a=document.createElement("div")).classList.add("oj-timepicker-wheel"),r&&a.classList.add(r);a.setAttribute("id","_ojWheel"+N.counter),N.counter+=1,a.setAttribute("tabIndex","0"),a.setAttribute("role","spinbutton"),f.wheel=a}();var D,k=t(a);return a.ojSpinUp=S,a.ojSpinDown=C,a.ojRefresh=I,a.ojDestroy=b,a.ojLinked=function(){return f.linked},D={recognizers:[[i.Pan,{direction:i.DIRECTION_VERTICAL}],[i.Tap],[i.Swipe,{direction:i.DIRECTION_VERTICAL}]]},k.ojHammer(D).on("tap",E).on("swipeup",P).on("swipedown",O).on("panstart",T).on("panend pancancel",A).on("panup pandown",M),a.addEventListener("wheel",L,{passive:!1}),a.addEventListener("keydown",j,!1),a.addEventListener("focus",x,!1),a.addEventListener("blur",V,!1),I(),a;function b(){k.ojHammer().off("tap",E).off("swipeup",P).off("swipedown",O).off("panstart",T).off("panend pancancel",A).off("panup pandown",M),k.ojHammer("destroy")}function S(){if(g[u+1]){w(1);var e=g.shift();e&&a.removeChild(e);var t=R(f,u,y);t&&a.appendChild(t),g.push(t)}}function C(){if(g[u-1]){w(-1);var e=g.pop();e&&a.removeChild(e);var t=R(f,-u,y);t&&a.insertBefore(t,g[0]),g.unshift(t)}}function w(e){for(var t=0;t<g.length;t++){var i=g[t];i&&i.ojUpdatePosition(t-u-e)}a.setAttribute("aria-valuenow",f.getText(0))}function I(){g.forEach(function(e){e&&a.removeChild(e)}),g=[];for(var e=-u;e<=u;e++){var t=R(f,e,y);t&&a.appendChild(t),g.push(t)}a.setAttribute("aria-valuenow",f.getText(0))}function j(e){var t=e.keyCode;switch(t){case m:f.position+=1,e.preventDefault();break;case v:f.position-=1,e.preventDefault();break;case _:f.keyboardValue=f.keyboardValue.slice(0,-1),e.preventDefault();break;default:(t>47&&t<58||t>95&&t<112||!n&&t>64&&t<91)&&(f.keyboardValue+=e.key)}}function E(e){a.focus();for(var t=(e.gesture.center.y-a.getBoundingClientRect().top)/k.height(),i=0;i<4&&t>d[i];)i+=1;2!==i&&(f.position+=i-2)}function P(e){a.focus();var t=e.gesture.velocityY,i=t*t/p;c=Math.floor(i/k.height()*5),e.preventDefault()}function O(e){a.focus();var t=e.gesture.velocityY,i=t*t/p;c=-Math.floor(i/k.height()*5),e.preventDefault()}function T(e){a.focus(),o=e.gesture.center.y,s=o,l=0,c=0}function A(){a.focus(),c&&(f.position+=c),s=null,o=null,l=null}function M(e){a.focus();var t=e.gesture.center.y,i=Math.round((s-t)/k.height()*5);i!==l&&Math.abs(o-t)>h&&(o=t,f.position+=i-l,l=i),e.preventDefault()}function L(e){e.deltaY&&(e.currentTarget.focus(),e.preventDefault()),e.deltaY<0&&(f.position+=1),e.deltaY>0&&(f.position-=1)}function x(){f.keyboardValue="",a.classList.add("oj-focus")}function V(){a.classList.remove("oj-focus"),f.update()}}function R(e,i,n){var r,a,s=!1;function o(){r.parentNode.focus()}var l=e.getText(i);if(l){(r=document.createElement("div")).classList.add("oj-timepicker-wheel-item"),r.classList.add("oj-timepicker-wheel-item-position"+i),a=i,e.isDisabled(i)&&(s=!0,r.classList.add("oj-disabled")),r.ojUpdatePosition=function(e){return r.classList.remove("oj-timepicker-wheel-item-position"+a),r.classList.add("oj-timepicker-wheel-item-position"+e),a=e,Promise.resolve()};var c=document.createElement("div");c.textContent=l,c.classList.add("oj-timepicker-wheel-item-content"),n&&c.setAttribute("title",l),r.appendChild(c),Object.defineProperty(r,"ojDisabled",{enumerable:!0,get:function(){return s},set:function(e){e!==s&&(t(r).toggleClass("oj-disabled"),s=e)}}),r.addEventListener("focus",o,!1),c.addEventListener("focus",o,!1)}return r}function x(e,t){var i,n,r,a,s,o,l,c=[150,100,50,25,16],u=0,h=e,d=0,p=0,_=1,m=1,v=1,f="",g=1,y=!1,D=this;function k(){if(t)for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i];D[n]=t[n]}}function b(){var e=!1,t=h.value;D.value=I(t);var l,c=h.max;l=j(t)===j(c)?I(c)+1:m,r!==l&&(e=!0,r=l);var u,d=h.min;u=j(t)===j(d)?I(d):0,n!==u&&(e=!0,n=u);var p=h.increment,_=function e(t,i){if(0===i)return t;return e(i,t%i)}(p,o);_===o?(n=0,r=1,e=!0):D.linked&&p>s?_=p:0===C(_,s)?_/=s:_=1,v!==_&&(v=_,e=!0),i=Math.floor(m/v),a=i>4,D.wheel&&e&&D.wheel.ojRefresh()}function S(){o=s*m,l=g*_}function C(e,t){return(e%t+t)%t}function w(e,t){return Math.floor(e/o)*o+C(t,m)*s+C(e,s)}function I(e){return C(Math.floor(e/s),m)}function j(e){return Math.floor(e/o)}Object.defineProperty(D,"position",{enumerable:!0,get:function(){return d},set:function(e){var t=C(e,i)*v;t>=n&&t<r&&e!==d&&(D.value+=(e-d)*v)}}),Object.defineProperty(D,"value",{enumerable:!0,get:function(){return u},set:function(e){var t=Math.round(e/v)*v;(function(e){return!!a||n<=e&&e<r})(t)&&u!==t&&(u=C(t,m),function(){var e,t=C((e=u,Math.floor(e/v)),i),n=C(D.position,i),r=t-n;a&&(t>n?n+i-t<Math.abs(r)&&(r=t-n-i):t+i-n<Math.abs(r)&&(r=t+i-n)),0!==r&&(d+=r,D.wheel?y||(y=!0,function e(){if(D.wheel){c.forEach(function(e){D.wheel.classList.remove("oj-timepicker-wheel-spin-"+e)});var t,i=Math.abs(d-p);if(0!==i)i-=1,i=Math.min(i,c.length-1),t=c[i],D.wheel.classList.add("oj-timepicker-wheel-spin-"+c[i]),d>p&&(p+=1,D.wheel.ojSpinUp()),d<p&&(p-=1,D.wheel.ojSpinDown()),t&&(h.disableSpin?e.call(D):setTimeout(e.bind(D),t));else y=!1}}.call(D)):p=d)}(),D.linked&&(2===m&&(h.disableSpin=!0),h.value=w(h.value,u),h.disableSpin=!1))}}),Object.defineProperty(D,"increment",{enumerable:!0,get:function(){return v},set:function(e){v!==e&&(v=e,S())}}),Object.defineProperty(D,"valueMultiplier",{enumerable:!0,get:function(){return s},set:function(e){s!==e&&(s=e,S())}}),Object.defineProperty(D,"valueRange",{enumerable:!0,get:function(){return m},set:function(e){m!==e&&(m=e,S())}}),Object.defineProperty(D,"displayMultiplier",{enumerable:!0,get:function(){return g},set:function(e){g!==e&&(g=e,S())}}),Object.defineProperty(D,"displayRange",{enumerable:!0,get:function(){return _},set:function(e){_!==e&&(_=e,S())}}),Object.defineProperty(D,"keyboardValue",{enumerable:!0,get:function(){return f},set:function(e){if(f=e,D.parser&&f){var t=D.parser(f);t>=0&&(i=u,a=t,t=Math.floor(i/l)*l+C(a,_)*g+C(i,g),n<=t&&t<r&&(D.value=t)),f.length>=2?f="":setTimeout(function(){f=""},1e3)}var i,a}}),D.getText=function(e){var t,n=C(p,i)+e,r=a||n>=0&&n<i;if(D.formatter&&r){var s=function(e){return t=function(e){return C(C(e,i)*v,m)}(e),C(Math.floor(t/g),_);var t}(p+e);t=D.formatter(s)}return t},D.isDisabled=function(e){var t=C(p+e,i)*v;return 0!==n&&t<n||r!==m&&t>=r},D.update=function(){h.value=w(h.value,u)},D.refresh=b,D.setProperties=k,k()}e.__registerWidget("oj.ojInputTime",t.oj.inputBase,{widgetEventPrefix:"oj",_CLASS_NAMES:"oj-inputdatetime-input",_WIDGET_CLASS_NAMES:"oj-inputdatetime-time-only oj-component oj-inputdatetime oj-text-field",_INPUT_CONTAINER_CLASS:"oj-inputdatetime-input-container oj-text-field-container",_ELEMENT_TRIGGER_WRAPPER_CLASS_NAMES:"",_INPUT_HELPER_KEY:"inputHelp",_ATTR_CHECK:[{attr:"type",setMandatory:"text"}],_GET_INIT_OPTIONS_PROPS_FOR_WIDGET:[{attribute:"disabled",validateOption:!0},{attribute:"pattern"},{attribute:"title"},{attribute:"placeholder"},{attribute:"value",coerceDomValue:S},{attribute:"required",coerceDomValue:!0,validateOption:!0},{attribute:"readonly",option:"readOnly",validateOption:!0},{attribute:"min",coerceDomValue:S},{attribute:"max",coerceDomValue:S}],_TIME_PICKER_ID:"ojInputTime",_TRIGGER_CLASS:"oj-inputdatetime-input-trigger",_TRIGGER_TIME_CLASS:"oj-inputdatetime-time-icon",_ON_CLOSE_REASON_SELECTION:"selection",_ON_CLOSE_REASON_CANCELLED:"cancelled",_ON_CLOSE_REASON_TAB:"tab",_ON_CLOSE_REASON_CLOSE:"close",_KEYBOARD_EDIT_OPTION_ENABLED:"enabled",_KEYBOARD_EDIT_OPTION_DISABLED:"disabled",options:{converter:new h.IntlDateTimeConverter({hour:"2-digit",minute:"2-digit"}),keyboardEdit:"enabled",max:void 0,min:void 0,datePickerComp:null,pickerAttributes:null,renderMode:"jet",timePicker:{footerLayout:"",timeIncrement:"00:05:00:00",showOn:"focus"}},_InitOptions:function(t,i){this._super(t,i),null!==this.options.datePickerComp||this._IsCustomElement()||e.EditableValueUtils.initializeOptionsFromDom(this._GET_INIT_OPTIONS_PROPS_FOR_WIDGET,i,this)},_getPrependNode:function(){return this._isIndependentInput()?t("body"):t(".oj-popup-content",this._datePickerComp.widget._popUpDpDiv.ojPopup("widget"))},_InitBase:function(){this._timePickerDefaultValidators={},this._datePickerComp=this.options.datePickerComp,this._inputContainer=null,this._redirectFocusToInputContainer=!1,this._isMobile=!1,this._ignoreShow=!1,this._nativePickerShowing=!1,!0!==this.options.readOnly&&this._createWheelPicker(),this._isIndependentInput()&&(this._ELEMENT_TRIGGER_WRAPPER_CLASS_NAMES+=this._INPUT_CONTAINER_CLASS)},_UseReadonlyDiv:function(){return(!this._isContainedInDateTimePicker()||!this._isDatePickerInline())&&this._superApply(arguments)},_createWheelPicker:function(){var i=this.options.pickerAttributes,n=document.createElement("div");n.className="oj-timepicker-popup",n.style.display="none";var r=document.createElement("div");r.id=this._GetSubId(this._TIME_PICKER_ID);var a="oj-timepicker-content";"phone"===v.getDeviceRenderMode()&&(a+=" oj-timepicker-mobile-content"),r.className=a,n.appendChild(r),this._wheelPicker=t(n);var s=this._getPrependNode()[0];if(s.insertBefore(n,s.firstElementChild),this._isIndependentInput()){this._popUpWheelPicker=this._wheelPicker.ojPopup({initialFocus:"none",role:"dialog",chrome:"default",modality:k?"modeless":"modal",open:function(){},beforeClose:function(){},animateStart:function(e,t){"open"===t.action&&(e.preventDefault(),_.slideIn(t.element,{offsetY:t.element.offsetHeight+"px"}).then(t.endCallback))},animation:{open:null,close:null}}).attr("data-oj-internal",""),this.element.attr("data-oj-popup-"+this._popUpWheelPicker.attr("id")+"-parent",""),i&&e.EditableValueUtils.setPickerAttributes(this._popUpWheelPicker.ojPopup("widget"),i)}},_timepickerShowing:function(){var e;if(this._isIndependentInput())return(e=this._popUpWheelPicker)&&a.isComponentInitialized(e,"ojPopup")&&e.ojPopup("isOpen")||this._nativePickerShowing;var t=this._datePickerComp.widget;return e=t._popUpDpDiv,t._isShowingDatePickerSwitcher()&&e&&a.isComponentInitialized(e,"ojPopup")&&e.ojPopup("isOpen")||this._nativePickerShowing},_GetDefaultConverter:function(){return new h.IntlDateTimeConverter({hour:"2-digit",minute:"2-digit"})},_CreateConverters:function(){var e=function(e){this._createOffsetConverter(e)}.bind(this),t=this._GetConverter();t instanceof Promise?(this._resolveConverterBusyState=this._SetConverterBusyState("time"),this._converterPromise=t.then(function(t){e(t)})):e(t)},_ComponentCreate:function(){this._CreateConverters(),this._InitBase();var e=this._superApply(arguments);return this._isContainedInDateTimePicker()&&!this._isDatePickerInline()?this._CLASS_NAMES="":E(this),this._processReadOnlyKeyboardEdit(),e},_validateTime:function(e,t,i){var n;try{n=u.IntlConverterUtils._dateTime(e,t,i)}catch(e){m.info("The value of the InputTime element should be an ISOString, please use a valid ISOString");var r=new Date;r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0);var a=u.IntlConverterUtils.dateToLocalIso(r);n=u.IntlConverterUtils._dateTime(a,t,i)}return n},_SetConverterBusyState:function(e){var t=this.element[0],i=n.getContext(t).getBusyContext(),r="The page is waiting for async "+e+" converter loading ";return t&&t.id&&(r+='for "'+t.id+'" '),r+="to finish.",i.addBusyState({description:r})},_AfterCreate:function(){return this._superApply(arguments)},_AfterCreateConverterCached:function(){var e=this._super(),t=function(){var e;if((!0!==this.options.readOnly&&this._isIndependentInput()&&this._attachTrigger(),this._isIndependentInput())&&(!0!==this.options.readOnly&&I(this._triggerNode[0].children,this.options.disabled),!this._IsCustomElement())){var t=this.$label;this._inputContainer&&t&&1===t.length&&(e=t.attr("id"),this._inputContainer.attr("aria-labelledby",e))}this._resolveConverterBusyState&&(this._resolveConverterBusyState(),delete this._resolveConverterBusyState)}.bind(this);if(this._converterPromise){var i=this;this._converterPromise.then(function(){t(),delete i._converterPromise})}else t();return e},_createDateTimeRangeValidator:function(e){var t=this.options,i=this._GetDefaultStyleClass(),n=function(e){var n=C(t,e,i);if(n instanceof Promise){var r=this;return n.then(function(e){return r._dateTimeRangeValidator=e,e})}return this._dateTimeRangeValidator=n,n}.bind(this);return e instanceof Promise?e.then(function(e){return n(e)}):n(e)},_getDateTimeRangeValidator:function(){return this._dateTimeRangeValidator},_setValidatorOption:function(e,t){var i=this,n=function(t){i._timePickerDefaultValidators[e]=t,i._AfterSetOptionValidators()};t instanceof Promise?t.then(function(e){n(e)}):n(t)},_setOption:function(t,i,n){var r,a=null;if("value"===t)return i||(i=null),a=this._super(t,i,n),this._createWheelPickerDom(!0),a;"timePicker"===t&&void 0===i.footerLayout&&(r=this.options.timePicker.footerLayout),a=this._superApply(arguments),r&&(this.options.timePicker.footerLayout=r),"disabled"===t&&this._isIndependentInput()?(i&&this._hide(this._ON_CLOSE_REASON_CLOSE),this._triggerNode&&(this._triggerNode.find("."+this._TRIGGER_TIME_CLASS).attr("title",this._getTimeTitle()),I(this._triggerNode[0].children,i))):"max"!==t&&"min"!==t||this._isContainedInDateTimePicker()?"readOnly"===t?(this._processReadOnlyKeyboardEdit(),i?this._hide(this._ON_CLOSE_REASON_CLOSE):null==this._wheelPicker&&(this._createWheelPicker(),this._isIndependentInput()&&(this._attachTrigger(),I(this._triggerNode[0].children,this.options.disabled)),this._setupResizePopupBind()),this._AfterSetOptionDisabledReadOnly("readOnly",e.EditableValueUtils.readOnlyOptionOptions)):"keyboardEdit"===t&&this._processReadOnlyKeyboardEdit():this._setValidatorOption("dateTimeRange",this._createDateTimeRangeValidator(this._GetConverter()));return t in{max:!0,min:!0,converter:!0,timePicker:!0}&&this._createWheelPickerDom(),a},_destroy:function(){return this._cleanUpTimeResources(),this._super()},_clearWheelModels:function(){var e=this._timePickerModel;if(e){var t=e.getWheelModel("hour");t&&(t.wheel=void 0),(t=e.getWheelModel("minute"))&&(t.wheel=void 0),(t=e.getWheelModel("ampm"))&&(t.wheel=void 0)}},_destroyHammer:function(){if(this._wheelGroup&&this._wheelGroup.length)for(var e=this._wheelGroup[0].children,t=0;t<e.length;t++)e[t].ojDestroy()},_SetupResources:function(){return!0!==this.options.readOnly&&this._setupResizePopupBind(),this._super()},_setupResizePopupBind:function(){this._resizePopupBind=function(){t(".oj-timepicker-content",this._wheelPicker)[k?"removeClass":"addClass"]("oj-timepicker-fixedheight"),this._isIndependentInput()&&a.isComponentInitialized(this._popUpWheelPicker,"ojPopup")&&this._popUpWheelPicker.ojPopup("option","modality",k?"modeless":"modal")}.bind(this),window.addEventListener("resize",this._resizePopupBind,!1)},_ReleaseResources:function(){return this._IsCustomElement()&&this._cleanUpListeners(),this._super()},_cleanUpTimeResources:function(){this._isIndependentInput()&&(this.element.off("focus"),this.element[0].removeEventListener("touchstart",this._timepickerTouchStartListener,{passive:!1}),delete this._timepickerTouchStartListener,this._wrapper[0].removeEventListener("touchstart",this._timepickerWrapperTouchStartListener,{passive:!0}),delete this._timepickerWrapperTouchStartListener),this._triggerNode&&this._triggerNode.remove(),this._cleanUpListeners(),this._destroyHammer(),this._wheelPicker&&(this._wheelPicker.remove(),this._clearWheelModels()),this._isIndependentInput()&&this._popUpWheelPicker&&a.isComponentInitialized(this._popUpWheelPicker,"ojPopup")&&this._popUpWheelPicker.ojPopup("destroy")},_cleanUpListeners:function(){this._resizePopupBind&&window.removeEventListener("resize",this._resizePopupBind)},_processReadOnlyKeyboardEdit:function(){if(this._isIndependentInput()){var e=this.options.readOnly||this._isKeyboardEditDisabled();this.element.prop("readOnly",!!e)}},_isKeyboardEditDisabled:function(){return this.options.keyboardEdit===this._KEYBOARD_EDIT_OPTION_DISABLED},_AppendInputHelper:function(){this._isIndependentInput()&&this._superApply(arguments)},_onKeyDownHandler:function(e){if(this._isIndependentInput()){this._superApply(arguments);var i=t.ui.keyCode,n=!1;if(this._timepickerShowing())switch(e.keyCode){case i.TAB:this._hide(this._ON_CLOSE_REASON_TAB);break;case i.ESCAPE:this._hide(this._ON_CLOSE_REASON_CANCELLED),n=!0;break;case i.UP:case i.DOWN:this._wheelGroup.children().first().focus(),n=!0}else switch(e.keyCode){case i.UP:case i.DOWN:var r=this._GetConverter().parse(this._GetDisplayValue());this._SetValue(r,e),this._isTimePickerSupported()&&this.show(),n=!0}if(n||e.keyCode===i.ENTER)return e.preventDefault(),e.stopPropagation(),!1}},_getTimeTitle:function(){return this._EscapeXSS(this.getTranslatedString("tooltipTime"+(this.options.disabled?"Disabled":"")))},_CreateContainerWrapper:function(){return this._inputContainer=t(this._superApply(arguments)),this._inputContainer.attr({role:"presentation",tabindex:"-1"}),this.element.attr({role:"combobox","aria-haspopup":"true"}),this._inputContainer[0]},_IsTextFieldComponent:function(){return!this._isInLine},_GetContentWrapper:function(){if(this._IsCustomElement())return this._getRootElement().querySelector(".oj-text-field-middle")},_onElementFocus:function(){var e=this.options.timePicker.showOn;this._redirectFocusToInputContainer?(this._redirectFocusToInputContainer=!1,P(this)?this._inputContainer.focus():this._wheelGroup.children().first().focus()):"focus"===e?this._isTimePickerSupported()&&this.show():this._timepickerShowing()&&this._hide(this._ON_CLOSE_REASON_CLOSE)},_OnElementTouchStart:function(e){if(e.preventDefault(),"focus"===this.options.timePicker.showOn)if(this._timepickerShowing())this._ignoreShow=!0,this._hide(this._ON_CLOSE_REASON_CLOSE);else{var t=this.element[0]===document.activeElement;this._isTimePickerSupported()&&(this.show(),this._redirectFocusToInputContainer=!0),P(this)&&t&&this._inputContainer.focus()}},_attachTrigger:function(){var e=this.options.timePicker.showOn,i=document.createElement("span");i.className=this._TRIGGER_CLASS;var n=document.createElement("span");n.setAttribute("title",this._getTimeTitle()),n.className=this._TRIGGER_TIME_CLASS+" oj-clickable-icon-nocontext oj-component-icon";var r=this;this.element.on("focus",t.proxy(this._onElementFocus,this)),this._timepickerTouchStartListener=t.proxy(this._OnElementTouchStart,this),this.element[0].addEventListener("touchstart",this._timepickerTouchStartListener,{passive:!1});var a=this._wrapper;if(this._timepickerWrapperTouchStartListener=function(){r._isMobile=!0},a[0].addEventListener("touchstart",this._timepickerWrapperTouchStartListener,{passive:!0}),"image"===e&&(n.style.display="block",this._IsRTL()?(this.element.css("border-top-left-radius",0),this.element.css("border-bottom-left-radius",0)):(this.element.css("border-top-right-radius",0),this.element.css("border-bottom-right-radius",0))),!P(this)){i.appendChild(n),n.addEventListener("click",function(){r._timepickerShowing()?r._hide(r._ON_CLOSE_REASON_CLOSE):r._isTimePickerSupported()&&(r.show(),r._wheelGroup.children().first().focus())});var s=t(n);this._AddHoverable(s),this._AddActiveable(s),this._triggerIcon=s}this._triggerNode=t(i);var o=this.element[0].parentNode;this._isTimePickerSupported()&&o.parentNode.insertBefore(i,o.nextElementSibling)},_getValue:function(){return this._isContainedInDateTimePicker()?this._datePickerComp.widget.getValueForInputTime():this.options.value},_onBlurHandler:function(e){this._isIndependentInput()&&this._superApply(arguments)},show:function(){this._timepickerShowing()||this.options.disabled||this.options.readOnly||(this._ignoreShow?this._ignoreShow=!1:P(this)?(this.element.blur(),this._showNativeTimePicker()):this._showWheelPicker())},_createOffsetConverter:function(e){this._offsetConverter=L(e,{isoStrFormat:"offset"})},_getOffsetConverter:function(){return this._offsetConverter},_showNativeTimePicker:function(){var e={},t=this._getOffsetConverter(),i=b(t,this._getIsoDateValue(t));e.date=i,e.mode="time";var n=M(this.options.timePicker.timeIncrement);e.minuteInterval=0===n.hourIncr?n.minuteIncr:1;var r=this._isContainedInDateTimePicker()?this._datePickerComp.widget.options.min:this.options.min,a=this._isContainedInDateTimePicker()?this._datePickerComp.widget.options.max:this.options.max;if(r){var s=b(t,u.IntlConverterUtils._minMaxIsoString(r,this._getIsoDateValue(t)));e.minDate=s.valueOf()}if(a){var o=b(t,u.IntlConverterUtils._minMaxIsoString(a,this._getIsoDateValue(t)));e.maxDate=o.valueOf()}var l=this;this._nativePickerShowing=!0,window.datePicker.show(e,function(e){if(l._nativePickerShowing=!1,e){var t=l._getOffsetConverter(),i=u.IntlConverterUtils._dateTime(l._getIsoDateValue(t),{hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}),n=l._GetConverter().format(i);l._SetValue(n,{})}l._onClose(l._ON_CLOSE_REASON_SELECTION)},function(e){l._nativePickerShowing=!1,e.startsWith("cancel")?l._onClose(l._ON_CLOSE_REASON_CANCELLED):m.error("Error: native time picker failed: "+e)})},hide:function(){return this._hide(this._ON_CLOSE_REASON_CLOSE)},_hide:function(e){return!P(this)&&this._timepickerShowing()&&(this._popUpWheelPicker.ojPopup("close"),this._onClose(e)),this},_onClose:function(e){this._isMobile&&"focus"===this.options.timePicker.showOn?(this._isIndependentInput()?this._inputContainer:this._datePickerComp.widget._inputContainer).focus():("focus"===this.options.timePicker.showOn&&(this._isIndependentInput()?this._ignoreShow=!0:this._datePickerComp.widget._ignoreShow=!0),this.element.focus())},refresh:function(){return this._triggerNode&&this._triggerNode.find("."+this._TRIGGER_TIME_CLASS).attr("title",this._getTimeTitle()),this._superApply(arguments)||this},_SetDisplayValue:function(e){this._isIndependentInput()&&this._superApply(arguments),this._timepickerShowing()&&this._createWheelPickerDom(!0)},_SetValue:function(e,t,i){var n=!1;if(this._isContainedInDateTimePicker())try{var r,a=this._GetDefaultConverter(),s=this._datePickerComp.widget;r=t&&t.target&&t.target===this.element[0]&&!this._isDatePickerInline()?s._GetConverter():this._GetConverter();var o=new Date,l=u.IntlConverterUtils,c=s.getValueForInputTime()||l.dateToLocalIso(o),h=e;try{l._dateTime(e,{month:o.getMonth(),date:o.getDate(),fullYear:o.getFullYear(),hours:o.getHours(),minutes:o.getMinutes(),seconds:o.getSeconds()})}catch(t){h=r.parse(e)}var d=l._copyTimeOver(h,c),p=r.parse(d);if(p&&0===a.compareISODates(c,p))return!1;s.timeSelected(p,t),this._isDatePickerInline()&&(n=this._super(e,null,i))}catch(t){n=this._super(e,null,i)}else n=this._superApply(arguments);return n},_DoWrapElement:function(){return this._isIndependentInput()},_isIndependentInput:function(){return!this._isContainedInDateTimePicker()||this._isDatePickerInline()},_GetDefaultStyleClass:function(){return"oj-inputtime"},_GetElementValue:function(){return this.options.value||""},_GetImplicitValidators:function(){var e=this._superApply(arguments);if((null!=this.options.min||null!=this.options.max)&&!this._isContainedInDateTimePicker()){var t=C(this.options,this._GetConverter(),this._GetDefaultStyleClass());this._timePickerDefaultValidators.dateTimeRange=t}return Object.assign(this._timePickerDefaultValidators,e)},_ResetAllValidators:function(){this._timePickerDefaultValidators={},this._superApply(arguments)},_GetConverter:function(){if(this.options.converter)return this._superApply(arguments);var e=this._GetDefaultConverter();return this.option("converter",e,{_context:{writeback:!0,internalSet:!0}}),e},_isContainedInDateTimePicker:function(){return null!==this._datePickerComp},_isDatePickerInline:function(){return this._datePickerComp.inline},_NotifyDetached:function(){this._hide(this._ON_CLOSE_REASON_CLOSE),this._superApply(arguments)},_NotifyHidden:function(){this._hide(this._ON_CLOSE_REASON_CLOSE),this._superApply(arguments)},_generateHeader:function(){var e=this._EscapeXSS(this.getTranslatedString("cancelText")),t="<a role='button' onclick='return false;' href='#' class='oj-enabled oj-default oj-timepicker-cancel-button' aria-label='"+e+"'>"+e+"</a>",i=this._EscapeXSS(this.getTranslatedString("okText")),n="<a role='button' onclick='return false;' href='#' class='oj-enabled oj-default oj-timepicker-ok-button' aria-label='"+i+"'>"+i+"</a>",r="<div class='oj-timepicker-header"+(this.options.disabled?" oj-disabled ":" oj-enabled oj-default ")+"'>";return r+=t,r+=n,r+="</div>"},_generateFooter:function(e,t){var i="",n="<a role='button' onclick='return false;' href='#' class='oj-timepicker-now oj-priority-secondary oj-enabled'>"+this._EscapeXSS(this.getTranslatedString("currentTimeText"))+"</a>";if(e&&e.length>1){var r=0,a=[{index:e.indexOf("now"),content:t?n:""}];for(a.sort(function(e,t){return e.index-t.index});r<a.length&&a[r].index<0;)r+=1;for(;r<a.length;)i+=a[r].content,r+=1;i.length>0&&(i="<div class='oj-timepicker-footer'>"+i+"</div>")}return i},_getIsoDateLimit:function(e,t,i){var n=this._isContainedInDateTimePicker()?this._datePickerComp.widget.options[t]:this.options[t],r=(n=(n=n?u.IntlConverterUtils._minMaxIsoString(n,this._getValue()):n)?e.parse(n):n)?u.IntlConverterUtils._clearTime(n):null;return i&&r&&i.substring(0,i.indexOf("T"))!==r.substring(0,r.indexOf("T"))&&(n=null),n},_getIsoDateValue:function(e){var t=this._getValue();return t||((t=new Date).setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t=u.IntlConverterUtils.dateToLocalIso(t)),t=e.parse(t)},_getAmPmStrings:function(){var e=new h.IntlDateTimeConverter({pattern:"a"});return[e.format("2016-01-01T01:00:00Z"),e.format("2016-01-01T13:00:00Z")]},_getWheelPickerContent:function(e){return e?t(e.find(".oj-timepicker-content")[0]):null},_createWheelPickerDom:function(e){var i=t.oj.ojInputTime.prototype.options.converter;if(null!=this._wheelPicker){e||this._detachWheelHandler();var n=this._wheelPicker,r=this._getWheelPickerContent(n);this._destroyHammer(),e?t(".oj-timepicker-wheel-group",r).remove():r.empty();var a=this._GetConverter(),s=a.resolvedOptions(),o=t.extend({},s);"zulu"===o.isoStrFormat&&(o.isoStrFormat="offset",o=(a=new h.IntlDateTimeConverter(o)).resolvedOptions());var l=u.IntlConverterUtils,c=this._getValue(),d=new Date;c||(c=u.IntlConverterUtils.dateToLocalIso(d));var p=this._validateTime(c,{month:d.getMonth(),date:d.getDate(),fullYear:d.getFullYear(),hours:d.getHours(),minutes:d.getMinutes(),seconds:d.getSeconds()});c=a.parse(p);var _=l._clearTime(c),v=this._getIsoDateLimit(a,"min",_),f=this._getIsoDateLimit(a,"max",_),g=this.options.timePicker.footerLayout,y=new function(e){var t,i,n,r=/^.*T(\d{2})(?::?(\d{2}).*$)/,a=720,s={h:function(e){if(0===e)return"12";return""+e},hh:function(e){if(0===e)return"12";return(e="0"+e).slice(-2)},H:function(e){return""+e},HH:j,k:function(e){if(0===e)return"24";return""+e},kk:function(e){if(0===e)return"24";return(e="0"+e).slice(-2)},K:function(e){return""+e},KK:function(e){return(e="0"+e).slice(-2)},mm:E},o={h:O,hh:O,H:P,HH:P,k:T,kk:T,K:P,KK:P,mm:P},l=0,c=0,u=0,h=1440,d=1440,p="auto",_="",v=["AM","PM"],f=new x(this,{valueRange:60,displayRange:60,valueMultiplier:1,displayMultiplier:1}),g=new x(this,{valueMultiplier:60,displayMultiplier:1}),y=new x(this,{valueRange:2,displayRange:2,formatter:function(e){return v[e]},parser:function(e){if("a"===(e=e.toLowerCase().charAt()))return 0;if("p"===e)return 1;return-1},valueMultiplier:a,displayMultiplier:1}),D=[f,g,y],k=!1,b=this;function S(){try{if(k=!0,e)for(var t=Object.key(e),i=0;i<t.length;i++){var n=t[i];b[n]=e[n]}}finally{k=!1,C()}}function C(){if(!k){if(u=Math.ceil(c/t)*t,(d=Math.ceil((h-1)/t)*t)<u)throw new Error("Invalid min and max settings with current increment: "+c+" "+h+ +t);var e,i;if(l<u&&(l=u),l>d&&(l=d),l=Math.round(l/t)*t,n)switch(g.displayRange=12,"auto"===(e=p)&&((i=A(t,60))===t||60===i?e="hoursMeridiem":(i=A(t,a),e="all")),e){case"all":f.displayMultiplier=1,f.valueMultiplier=1,f.valueRange=1440,f.linked=!0,g.displayMultiplier=60,g.valueMultiplier=1,g.valueRange=1440,g.linked=!0,y.displayMultiplier=1,y.valueMultiplier=720,y.valueRange=2,y.linked=!0;break;case"hoursMeridiem":f.displayMultiplier=1,f.valueMultiplier=1,f.valueRange=60,f.linked=!1,g.displayMultiplier=1,g.valueMultiplier=60,g.valueRange=24,g.linked=!0,y.displayMultiplier=1,y.valueMultiplier=720,y.valueRange=2,y.linked=!0}else switch(g.displayRange=24,"auto"===(e=p)&&(i=A(t,60),e=i===t||60===i?"none":"all"),e){case"none":case"hoursMeridiem":f.displayMultiplier=1,f.valueMultiplier=1,f.valueRange=60,f.linked=!1,g.displayMultiplier=1,g.valueMultiplier=60,g.valueRange=24,g.linked=!1;break;case"all":case"hoursMinutes":f.displayMultiplier=1,f.valueMultiplier=1,f.valueRange=1440,f.linked=!0,g.displayMultiplier=60,g.valueMultiplier=1,g.valueRange=1440,g.linked=!0}for(var r=0;r<D.length;r++)D[r].refresh()}}function w(e){var t=r.exec(e),i=parseInt(t[1],10),n=parseInt(t[2],10);return 60*i+n}function I(e){e=Math.floor(e);var t=Math.floor(e/60);return e%=60,"T"+j(t)+":"+E(e)}function j(e){return(e="0"+e).slice(-2)}function E(e){return(e="0"+e).slice(-2)}function P(e){return e.match(/^\d+$/)?parseInt(e,10):-1}function O(e){if(e.match(/^\d+$/)){var t=parseInt(e,10);return 0===t&&(t=-1),24===t&&(t=0),t}return-1}function T(e){if(e.match(/^\d+$/)){var t=parseInt(e,10);return 0===t&&(t=-1),24===t&&(t=0),t}return-1}function A(e,t){return 0===t?e:A(t,e%t)}k=!0,Object.defineProperty(b,"increment",{enumerable:!0,get:function(){return t},set:function(e){t=Math.floor(e),C()}}),b.increment=1,Object.defineProperty(b,"grouped",{enumerable:!0,get:function(){return p},set:function(e){switch(e){case"auto":case"all":case"none":case"hoursMinutes":case"hoursMeridiem":p=e;break;default:throw new Error("invalid grouped value: "+e)}C()}}),Object.defineProperty(b,"min",{enumerable:!0,get:function(){return c},set:function(e){c=Math.floor(e),C()}}),Object.defineProperty(b,"isoMin",{enumerable:!0,get:function(){return I(c)},set:function(e){var t=w(e);isNaN(t)?m.error("Invalid ISO min time: %s",e):b.min=t}}),Object.defineProperty(b,"max",{enumerable:!0,get:function(){return h-1},set:function(e){h=Math.floor(e)+1,C()}}),Object.defineProperty(b,"isoMax",{enumerable:!0,get:function(){return I(h)},set:function(e){var t=w(e);isNaN(t)?m.error("Invalid ISO max time: %s",e):b.max=t}}),Object.defineProperty(b,"value",{enumerable:!0,get:function(){return l},set:function(e){l=Math.floor(e),C()}}),Object.defineProperty(b,"isoValue",{enumerable:!0,get:function(){return I(l)},set:function(e){var t=w(e);isNaN(t)?m.error("Invalid ISO value time: %s",e):b.value=t}}),Object.defineProperty(b,"format",{enumerable:!0,get:function(){return i},set:function(e){i=e;var t=e.replace(/'[^']*'/g,"").replace(/[^hHkKma]*/g,""),r=t.match(/([hHkK]+)/),a=r[1];g.formatter=s[a],g.parser=o[a];var l=(r=t.match(/(m+)/))[1];f.formatter=s[l],f.parser=o[l],n=_.indexOf("a")>=0,C()}}),Object.defineProperty(b,"wheelOrder",{enumerable:!0,get:function(){return _},set:function(e){_=e}}),Object.defineProperty(b,"ampmStrings",{enumerable:!0,get:function(){return v},set:function(e){v=e}}),k=!1,b.setProperties=S,S(),b.getWheelModel=function(e){switch(e){case"hour":return g;case"minute":return f;case"ampm":return n?y:null;default:return}}}(null);this._timePickerModel=y;for(var D=["","","",""],k=i._getTimePositioning(s),b=Object.keys(k),S=0;S<b.length;S++){var C=b[S];D[k[C]]=C}y.wheelOrder=D.filter(function(e){return!!e}).join("");var w=o.pattern||o.patternFromOptions;w?y.format=w:(w=(o=i.resolvedOptions()).pattern||o.patternFromOptions,y.format=w),y.ampmStrings=this._getAmPmStrings();var I=this.options.timePicker.timeIncrement;if(I){var j=M(I);y.increment=60*j.hourIncr+j.minuteIncr}try{y.isoValue=this._getIsoDateValue(a)}catch(e){y.isoValue=i.parse(p),m.info("The value of the InputTime element should be an ISOString, please use a valid ISOString")}v&&(y.isoMin=v),f&&(y.isoMax=f),!this._isIndependentInput()||e&&0!==t(".oj-timepicker-header",r).length||r.append(t(this._generateHeader(n))),this._wheelGroup=t(function(e){var i,n=37,r=39,a=[];return(i=document.createElement("div")).classList.add("oj-timepicker-wheel-group"),i.ojRefresh=c,i.addEventListener("keydown",s,!1),c(),i;function s(e){var i=e.target,a=e.keyCode;switch(a){case n:t(i).prev().focus();break;case r:t(i).next().focus()}}function o(e){var t=e.target;if(t.ojLinked())for(var i=0;i<a.length;i++)a[i].ojLinked()&&a[i].classList.add("oj-active");else t.classList.add("oj-active")}function l(){for(var e=0;e<a.length;e++)a[e].classList.remove("oj-active")}function c(){for(var t=i.firstChild;t;)t.ojDestroy(),i.removeChild(t),t=i.firstChild;a=[],function(){var t,n,r=e.wheelOrder,s=N(e.getWheelModel("hour"),!0,"oj-timepicker-hour"),c=N(e.getWheelModel("minute"),!0,"oj-timepicker-minute");r.indexOf("a")>=0&&(t=e.getWheelModel("ampm"),n=N(t,!1,"oj-timepicker-meridian"));var u,h=r.split("");for(u=0;u<h.length;u++)switch(h[u]){case"h":a.push(s);break;case"m":a.push(c);break;case"a":a.push(n);break;default:m.error("Unknown wheelOrder code: %s",h[u])}for(u=0;u<a.length;u++){var d=a[u];d.addEventListener("focus",o,!1),d.addEventListener("blur",l,!1),i.appendChild(d)}}()}}(y)),this._isIndependentInput()?this._wheelGroup.insertAfter(t(".oj-timepicker-header",r)):r.append(this._wheelGroup),e&&0!==t(".oj-timepicker-footer",r).length||r.append(t(this._generateFooter(g,d))),r.find(".oj-timepicker-hour").attr("aria-label",this.getTranslatedString("hourWheelLabel")),r.find(".oj-timepicker-minute").attr("aria-label",this.getTranslatedString("minuteWheelLabel")),r.find(".oj-timepicker-meridian").attr("aria-label",this.getTranslatedString("ampmWheelLabel")),e||this._attachWheelHandler()}},_detachWheelHandler:function(){this._wheelPicker.find(".oj-timepicker-now").off("click"),this._isIndependentInput()?(this._wheelPicker.find(".oj-timepicker-cancel-button").off("click"),this._wheelPicker.find(".oj-timepicker-ok-button").off("click"),this._wheelPicker.off("keydown")):this._wheelPicker.find(".oj-timepicker-wheel").off("blur")},_attachWheelHandler:function(){var e=this;if(this._wheelPicker.find(".oj-timepicker-now").on("click",function(t){var i,n=new Date,r=e._GetConverter(),a=r.resolvedOptions();i=void 0!==a.timeZone&&"local"!==a.isoStrFormat?n.toISOString():u.IntlConverterUtils.dateToLocalIso(n),i=r.parse(i),e._timePickerModel.isoValue=i,e._isIndependentInput()||e._SetValue(e._timePickerModel.isoValue,t),t.preventDefault()}),!this._isIndependentInput())return this._wheelPicker.find(".oj-timepicker-wheel").on("blur",function(t){e._SetValue(e._timePickerModel.isoValue,t)}),this._datePickerComp.widget._togglePicker(),void this._wheelGroup.children().first().focus();this._wheelPicker.find(".oj-timepicker-cancel-button").on("click",function(t){t.preventDefault(),e._hide(e._ON_CLOSE_REASON_CANCELLED)}),this._wheelPicker.find(".oj-timepicker-ok-button").on("click",function(t){e._hide(e._ON_CLOSE_REASON_SELECTION),e._SetValue(e._timePickerModel.isoValue,t),t.preventDefault()}),this._wheelPicker.on("keydown",function(i){i.keyCode===t.ui.keyCode.ESCAPE&&(i.preventDefault(),e._hide(e._ON_CLOSE_REASON_CANCELLED))})},_isTimePickerSupported:function(){return"enabled"===A||"disabled"===A&&"others"!==e.Config.getDeviceRenderMode()},_showWheelPicker:function(){this._createWheelPickerDom();var t=this._popUpWheelPicker;if(t)if(k){var i=e.PositionUtils.normalizeHorizontalAlignment({my:"start top",at:"start bottom",of:this.element,collision:"flipfit"},this._IsRTL());t.ojPopup("open",this.element[0].parentNode.parentNode,i)}else t.ojPopup("open",this.element[0].parentNode.parentNode,{my:{horizontal:"center",vertical:"bottom"},at:{horizontal:"center",vertical:"bottom"},of:window,collision:"flipfit"}),this._wheelGroup.children().first().focus()},getNodeBySubId:function(e){var i=null,n=e&&e.subId,r=this._wheelPicker,a=this._getWheelPickerContent(r);if(n)switch(n){case"oj-inputdatetime-time-icon":i=t(".oj-inputdatetime-time-icon",this._triggerNode)[0];break;case"oj-inputdatetime-time-input":i=this.element[0];break;case"oj-timepicker-content":i=a?a[0]:null;break;case"oj-timepicker-cancel-button":i=t(".oj-timepicker-cancel-button",r)[0];break;case"oj-timepicker-ok-button":i=t(".oj-timepicker-ok-button",r)[0];break;case"oj-timepicker-hour":i=t(".oj-timepicker-hour",r)[0];break;case"oj-timepicker-minute":i=t(".oj-timepicker-minute",r)[0];break;case"oj-timepicker-meridian":i=t(".oj-timepicker-meridian",r)[0];break;case"oj-timepicker-now":i=t(".oj-timepicker-now",r)[0];break;default:i=null}return i||this._superApply(arguments)},getSubIdByNode:function(e){var i=t(".oj-inputdatetime-time-icon",this._triggerNode),n=null,r=this._wheelPicker,a=this._getWheelPickerContent(r),s=[{selector:".oj-timepicker-cancel-button",ele:r},{selector:".oj-timepicker-ok-button",ele:r},{selector:".oj-timepicker-hour",ele:r},{selector:".oj-timepicker-minute",ele:r},{selector:".oj-timepicker-meridian",ele:r},{selector:".oj-timepicker-now",ele:r}];if(e===i[0])n="oj-inputdatetime-time-icon";else if(e===this.element[0])n="oj-inputdatetime-time-input";else if(a&&e===a[0])n="oj-timepicker-content";else for(var o=0;o<s.length;o++){var l=s[o],c=t(l.selector,l.ele);if(1===c.length&&c[0]===e){n=l.selector.substr(1);break}}return n||this._superApply(arguments)},widget:function(){return this._isIndependentInput()?this._super():this._datePickerComp.widget.widget()}}),a.setDefaultOptions({ojInputTime:{renderMode:a.createDynamicPropertyGetter(function(){return(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).renderMode}),keyboardEdit:a.createDynamicPropertyGetter(function(){return(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).keyboardEdit}),timePicker:a.createDynamicPropertyGetter(function(){return(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).timePicker})}}),N.counter=0;var V=t.oj.ojInputDate.prototype.options.converter,Y=t.oj.ojInputTime.prototype.options.converter;D=(r.parseJSONFromFontFamily("oj-inputdatetime-option-defaults")||{}).converterYear||"numeric";e.__registerWidget("oj.ojInputDateTime",t.oj.ojInputDate,{widgetEventPrefix:"oj",_WIDGET_CLASS_NAMES:"oj-inputdatetime-date-time oj-component oj-inputdatetime",_INPUT_HELPER_KEY:"inputHelpBoth",_TRIGGER_CALENDAR_CLASS:"oj-inputdatetime-calendar-clock-icon",options:{converter:new h.IntlDateTimeConverter({day:"2-digit",month:"2-digit",year:D,hour:"2-digit",minute:"2-digit"}),renderMode:"jet",timePicker:{footerLayout:"",timeIncrement:"00:05:00:00",showOn:"focus"}},_GetDefaultConverter:function(){return new h.IntlDateTimeConverter({day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"})},_CreateConverters:function(){this._super();var e=function(e){var t,i=[];return(t=this._createTimePickerConverter(e))instanceof Promise&&(this._timeConverterPromise=t,i.push(t)),i.length?Promise.all(i):null}.bind(this),t=this._GetConverter();t instanceof Promise?(this._resolveDateTimeConverterBusyState=this._SetConverterBusyState("datetime"),this._dateTimeConverterPromise=e(t)):e(t)},_InitBase:function(){this._super(),this._timePickerElement=this.element,this._timePicker=null,this._previousValue=null,this._switcherDiv=null,this._switcherPrevValue=null,this._switcherPrevDay=null,this._switcherPrevMonth=null,this._switcherPrevYear=null,this._switcherDateValue=null,this._switcherTimeValue=null,this._dateTimeSwitcherActive=null,this._isInLine||!0!==this.options.readOnly&&this._createSwitcherDiv()},_UseReadonlyDiv:function(){return!this._isInLine&&this._superApply(arguments)},_createSwitcherDiv:function(){this._switcherDiv=t(this._generateSwitcher()),this._popUpDpDiv.ojPopup("widget")[0].querySelector(".oj-popup-content").appendChild(this._switcherDiv[0]);var e=this;this._popUpDpDiv.on("ojclose",function(){null===e._switcherDateValue&&null===e._switcherTimeValue||(e._currentDay=e._switcherPrevDay,e._currentMonth=e._switcherPrevMonth,e._drawMonth=e._currentMonth,e._currentYear=e._switcherPrevYear,e._drawYear=e._currentYear,e._SetValue(e._switcherPrevValue),e._switcherTimeValue=null,e._switcherDateValue=null,e._switcherPrevDay=null,e._switcherPrevMonth=null,e._switcherPrevYear=null,e._switcherPrevValue=null)}),this._switcherDiv.find("[data-handler]").map(function(){var i={switchMe:function(i){var n=i.keyCode;if("keydown"===i.type&&(t.ui.keyCode.ENTER===n||t.ui.keyCode.SPACE===n)||"click"===i.type)return e._isShowingDatePickerSwitcher()?(e.show(),e._placeFocusOnCalendar()):e._timePicker.ojInputTime("show"),!1},switchDone:function(i){var n=i.keyCode;if("keydown"===i.type&&(t.ui.keyCode.ENTER===n||t.ui.keyCode.SPACE===n)||"click"===i.type){var r=e._GetConverter().format(e._getDateIso()),a=e._GetConverter().parse(r);e._switcherDateValue&&(a=e._switcherDateValue),e._switcherTimeValue&&(a=u.IntlConverterUtils._copyTimeOver(e._switcherTimeValue,a)),e._switcherPrevValue&&a&&!e._switcherTimeValue&&(a=u.IntlConverterUtils._copyTimeOver(e._switcherPrevValue,a));var s=e._GetConverter().format(a);return e._SetDisplayValue(s),e._SetValue(s,{}),e._switcherTimeValue=null,e._switcherDateValue=null,e._switcherPrevDay=null,e._switcherPrevMonth=null,e._switcherPrevYear=null,e._switcherPrevValue=null,e._hide(e._ON_CLOSE_REASON_SELECTION),!1}},switchCancel:function(i){var n=i.keyCode;if("keydown"===i.type&&(t.ui.keyCode.ENTER===n||t.ui.keyCode.SPACE===n)||"click"===i.type)return e._hide(e._ON_CLOSE_REASON_CANCELLED),!1}};t(this).bind(this.getAttribute("data-event"),i[this.getAttribute("data-handler")])})},_setupSwitcherButtons:function(){var e=this._switcherDiv.find("a");this._AddHoverable(e),this._AddActiveable(e)},_ComponentCreate:function(){var e=this._super();if(this._isInLine){var i=t("<input type='text'>");i.insertAfter(this.element),this._timePickerElement=i}else!0!==this.options.readOnly&&this._setupSwitcherButtons();return e},_createTimePicker:function(){for(var e=["title","placeholder","disabled","required","readOnly","keyboardEdit","pickerAttributes","renderMode"],i={},n=0,r=e.length;n<r;n++)i[e[n]]=this.options[e[n]];var a=this._isInLine?this.options.displayOptions.messages:"none",s=this.options.timePicker;if(this._GetConverter()instanceof Promise)this._timePicker=this._timePickerElement.ojInputTime(t.extend(i,{converter:this._timeConverter||this._timeConverterPromise,userAssistanceDensity:"compact",displayOptions:{converterHint:"none",title:"none",messages:a},value:this.options.value,timePicker:s,datePickerComp:{widget:this,inline:this._isInLine}}));else{var o=this._formatValueWithTimeConverter(this.options.value);this._timePicker=this._timePickerElement.ojInputTime(t.extend(i,{converter:this._timeConverter,userAssistanceDensity:"compact",displayOptions:{converterHint:"none",title:"none",messages:a},value:o,timePicker:s,datePickerComp:{widget:this,inline:this._isInLine}}))}},_AfterCreate:function(){var e=this._superApply(arguments);return this._createTimePicker(),this._dateTimeSwitcherActive=!P(this)&&this._timePicker&&!this._isInLine,e},_AfterCreateConverterCached:function(){var e=this._super(),t=function(){if(this._resolveDateTimeConverterBusyState&&(this._resolveDateTimeConverterBusyState(),delete this._resolveDateTimeConverterBusyState),null===this._timeConverter)throw new Error("Please use ojInputDate if your converter doesn't specify a time format.")}.bind(this);if(this._dateTimeConverterPromise){var i=this;this._dateTimeConverterPromise.then(function(){t(),delete i._dateTimeConverterPromise})}else t();return e},_setOption:function(e,t,i){var n=this._superApply(arguments);if("value"===e){var r=this._formatValueWithTimeConverter(this.options.value);this._previousValue=r}else"readOnly"===e&&(this._isInLine||t||null!=this._switcherDiv||(this._createSwitcherDiv(),this._setupSwitcherButtons(),this._createTimePicker()));if(this._timePicker){if(e in{disabled:!0,readOnly:!0,keyboardEdit:!0})this._timePicker.ojInputTime("option",e,t);else if("timePicker"===e)this._timePicker.ojInputTime("option","timePicker.timeIncrement",t.timeIncrement);else if("converter"===e){var a=function(t){this._createTimePickerConverter(t),this._timePicker.ojInputTime("option",e,this._timeConverter)}.bind(this),s=t||this._GetDefaultConverter();s instanceof Promise?s.then(function(e){a(e)}):s&&a(s)}}return n},_destroy:function(){return this._cleanUpDateTimeResources(),this._super()},_cleanUpDateTimeResources:function(){if(this._timePicker&&this._timePicker.ojInputTime("destroy"),this._isInLine)this._timePickerElement.remove();else if(this._switcherDiv){var e=this._switcherDiv.find("a");this._RemoveActiveable(e),this._RemoveHoverable(e),this._switcherDiv.remove()}},_formatValueWithTimeConverter:function(e){var t=e;try{this._getTimePickerConverter().format(e)}catch(e){m.info("The value of the InputDateTime element should be an ISOString, please use a valid ISOString"),t=this._getDefaultIsoDate()}return t},_GetCalendarTitle:function(){return this._EscapeXSS(this.getTranslatedString("tooltipCalendarTime"+(this.options.disabled?"Disabled":"")))},_generateSwitcher:function(){var e=document.createElement("div");e.className="oj-datetimepicker-switcher";var t=document.createElement("div");t.setAttribute("data-handler","switchMe"),t.setAttribute("data-event","click keydown");var i=document.createElement("div");return i.className="oj-inputdatetime-time-icon oj-clickable-icon-nocontext oj-component-icon oj-enabled oj-default",t.appendChild(i),(i=document.createElement("a")).setAttribute("onclick","return false;"),i.setAttribute("href","#"),i.className="oj-enabled oj-datetimepicker-switcher-text",i.setAttribute("role","button"),t.appendChild(i),e.appendChild(t),(t=document.createElement("div")).className="oj-datetimepicker-switcher-buttons",(i=document.createElement("a")).setAttribute("onclick","return false;"),i.setAttribute("href","#"),i.className="oj-enabled",i.setAttribute("data-handler","switchDone"),i.setAttribute("data-event","click keydown"),i.setAttribute("role","button"),i.textContent=this._EscapeXSS(this.getTranslatedString("done")),t.appendChild(i),(i=document.createElement("a")).setAttribute("onclick","return false;"),i.setAttribute("href","#"),i.className="oj-enabled",i.setAttribute("data-handler","switchCancel"),i.setAttribute("data-event","click keydown"),i.setAttribute("role","button"),i.textContent=this._EscapeXSS(this.getTranslatedString("cancel")),t.appendChild(i),e.appendChild(t),e},_updateSwitcherText:function(){if(this._switcherDiv){var e="";if(this._isShowingDatePickerSwitcher())try{e=V.format(this._switcherDateValue||this._getDateIso())}catch(t){e=V.format(this._getDefaultIsoDate())}else try{e=this._getTimePickerConverter().format(this._switcherTimeValue||this._getDateIso())}catch(t){e=Y.format(this._getDefaultIsoDate())}t(".oj-datetimepicker-switcher-text",this._switcherDiv).text(e)}},_isShowingDatePickerSwitcher:function(){return!this._switcherDiv||0===t(".oj-inputdatetime-time-icon",this._switcherDiv).length},_togglePicker:function(){var e,i,n,r,a,s=this._switcherDiv,o=!this._isShowingDatePickerSwitcher();o?(r="oj-inputdatetime-calendar-icon",n="oj-inputdatetime-time-icon",a="Set Date"):(r="oj-inputdatetime-time-icon",n="oj-inputdatetime-calendar-icon",a="Set Time");var l=t(s.children()[0]).children();t(l[0]).removeClass(n).addClass(r),t(l[1]).text(a),(l=t(".oj-popup-content",this._popUpDpDiv.ojPopup("widget")).children())[0].classList.contains("oj-datepicker-popup")?(e=t(l[0]),i=t(l[1])):(e=t(l[1]),i=t(l[0])),o?(e.css("display","none"),i.css("display","block")):(i.css("display","none"),e.css("display","block")),this._updateSwitcherText()},_createTimePickerConverter:function(e){var t=this,i=function(e){return t._timeConverter=L(e),t._timeConverter};return e instanceof Promise?e.then(function(e){return i(e)}):i(e)},_getTimePickerConverter:function(){return this._timeConverter},timeSelected:function(e,t){if(this._dateTimeSwitcherActive)this._switcherTimeValue=e;else{var i=this._GetConverter().format(e);this._SetDisplayValue(i),this._SetValue(i,t)}},getValueForInputTime:function(){var e=null;if(this.isValid())e=this.options.value;else if(this._previousValue)try{e=this._GetConverter().parse(this._previousValue)}catch(t){e=this.options.value}else e=null;return this._isDateTimeSwitcher()&&(e=this._switcherDateValue||e,this._switcherTimeValue&&e&&(e=u.IntlConverterUtils._copyTimeOver(this._switcherTimeValue,e))),e},_SetValue:function(e,t,i){var n=this._superApply(arguments);return this._previousValue=e,n},_SetDisplayValue:function(e){if(this._isInLine){var t=!(this._isInLine&&!this._dpDiv[0].contains(document.activeElement));this._updateDatepicker(t)}else this._superApply(arguments),this._updateSwitcherText();this._switcherTimeValue=null},_onKeyDownHandler:function(e){var i=t.ui.keyCode,n=!1;switch(e.keyCode){case i.UP:case i.DOWN:e.shiftKey&&(this._SetValue(this._GetDisplayValue(),e),this._timePicker.ojInputTime("show"),n=!0)}return n?(e.preventDefault(),e.stopPropagation(),!1):this._superApply(arguments)},show:function(){return this._isShowingDatePickerSwitcher()&&this._togglePicker(),this._super()},_ShowNativeDatePicker:function(e){e.mode="datetime";var t=M(this.options.timePicker.timeIncrement);return e.minuteInterval=0===t.hourIncr?t.minuteIncr:1,this._super(e)},_OnDatePicked:function(e){if(this._nativePickerShowing=!1,e){var t;t=this._validateDatetime(this._getDateIso(),{month:e.getMonth(),date:e.getDate(),fullYear:e.getFullYear(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()});var i=this._GetConverter().format(t);this._SetValue(i,{})}this._onClose(this._ON_CLOSE_REASON_SELECTION)},_ShowHTMLDatePicker:function(){var e=this._superApply(arguments),t=this._GetConverter();return t instanceof Promise?this._switcherPrevValue=this.options.value?this._getDateIso():"":this._switcherPrevValue=t.parse(this.options.value?this._getDateIso():""),this._switcherPrevDay=this._currentDay,this._switcherPrevMonth=this._currentMonth,this._switcherPrevYear=this._currentYear,this._updateSwitcherText(),e},showTimePicker:function(){this._datepickerShowing()||this.show(),this._isShowingDatePickerSwitcher()||this._timePicker.ojInputTime("show")},hideTimePicker:function(){return this.hide()},refresh:function(){var e=this._superApply(arguments)||this;return this._timePicker&&this._timePicker.ojInputTime("refresh"),this._switcherDiv&&(t("a[data-handler='switchDone']",this._switcherDiv).text(this.getTranslatedString("done")),t("a[data-handler='switchCancel']",this._switcherDiv).text(this.getTranslatedString("cancel"))),e},getNodeBySubId:function(e){var i=e&&e.subId,n=null;return i&&(n="oj-inputdatetime-date-input"===i?this._isInLine?this._timePickerElement[0]:this.element[0]:"oj-inputdatetime-calendar-clock-icon"===i?t(".oj-inputdatetime-calendar-clock-icon",this._triggerNode)[0]:this._timePicker?this._timePicker.ojInputTime("getNodeBySubId",e):null),n||this._superApply(arguments)},getSubIdByNode:function(e){var i=null;return this._isInLine?e===this._timePickerElement[0]&&(i="oj-inputdatetime-date-input"):e===this.element[0]?i="oj-inputdatetime-date-input":e===t(".oj-inputdatetime-calendar-clock-icon",this._triggerNode)[0]&&(i="oj-inputdatetime-calendar-clock-icon"),i||(this._timePicker?this._timePicker.ojInputTime("getSubIdByNode",e):null)||this._superApply(arguments)},_GetConverter:function(){if(this.options.converter)return this._superApply(arguments);var e=this._GetDefaultConverter();return this.option("converter",e,{_context:{writeback:!0,internalSet:!0}}),e},_NotifyDetached:function(){this._timePicker&&this.hideTimePicker(),this._superApply(arguments)},_NotifyHidden:function(){this._timePicker&&this.hideTimePicker(),this._superApply(arguments)},_GetMessagingLauncherElement:function(){return this._isInLine?this._timePickerElement:this._super()},_GetDefaultStyleClass:function(){return"oj-inputdatetime"},_SetLoading:function(){this._super(),this._timePicker&&this._timePicker.ojInputTime("option","readOnly",!0)},_ClearLoading:function(){this._super(),this._timePicker&&this._timePicker.ojInputTime("option","readOnly",this.options.readOnly)},_GetTranslationsSectionName:function(){return"oj-ojInputDate"}}),function(){var t={properties:{readonly:{binding:{consume:{name:"readonly"}}},userAssistanceDensity:{binding:{consume:{name:"userAssistanceDensity"}}}}};y.extension._WIDGET_NAME="ojInputTime",y.extension._INNER_ELEM="input",y.extension._GLOBAL_TRANSFER_ATTRS=["accesskey","aria-label","tabindex"],y.extension._ALIASED_PROPS={readonly:"readOnly"},e.CustomElementBridge.register("oj-input-time",{metadata:e.CollectionUtils.mergeDeep(y,t)}),f.extension._WIDGET_NAME="ojInputDate",f.extension._INNER_ELEM="input",f.extension._GLOBAL_TRANSFER_ATTRS=["accesskey","aria-label","tabindex"],f.extension._ALIASED_PROPS={readonly:"readOnly"},e.CollectionUtils.mergeDeep(f,t),e.CustomElementBridge.register("oj-input-date",{metadata:f});var i=Object.assign({},f);i.extension._INNER_ELEM="div",e.CustomElementBridge.register("oj-date-picker",{metadata:i}),g.extension._WIDGET_NAME="ojInputDateTime",g.extension._INNER_ELEM="input",g.extension._GLOBAL_TRANSFER_ATTRS=["accesskey","aria-label","tabindex"],g.extension._ALIASED_PROPS={readonly:"readOnly"},e.CollectionUtils.mergeDeep(g,t),e.CustomElementBridge.register("oj-input-date-time",{metadata:g});var n=Object.assign({},g);n.extension._INNER_ELEM="div",e.CustomElementBridge.register("oj-date-time-picker",{metadata:n})}()});