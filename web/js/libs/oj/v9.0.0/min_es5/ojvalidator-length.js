/**
 * @license
 * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["ojs/ojcore","ojs/ojtranslation","ojs/ojvalidator","ojs/ojvalidation-error"],function(t,a,n){"use strict";var e=function(t){this.Init(t)};return e.defaults={countBy:"codeUnit"},t.Object.createSubclass(e,n,"oj.LengthValidator"),e.prototype.Init=function(t){var a=t.countBy;if(e.superclass.Init.call(this),this._min=void 0!==t.min?parseInt(t.min,10):null,this._max=void 0!==t.max?parseInt(t.max,10):null,isNaN(this._min))throw new Error("length validator's min option is not a number. min option is "+t.min);if(isNaN(this._max))throw new Error("length validator's max option is not a number. max option is "+t.min);if(null!==this._min&&this._min<0)throw new Error("length validator's min option cannot be less than 0. min option is "+t.min);if(null!==this._max&&this._max<1)throw new Error("length validator's max option cannot be less than 1. max option is "+t.max);this._countBy=void 0===a?e.defaults.countBy:a,t&&(this._hint=t.hint||{},this._customMessageSummary=t.messageSummary||{},this._customMessageDetail=t.messageDetail||{})},e.prototype.getHint=function(){var t,n=null,e=this._hint,i=e.exact,o=e.inRange,r=e.max,s=e.min,l=this._max,m=this._min,h=a;return null!==m&&null!==l?m!==l?(t={min:m,max:l},n=o?h.applyParameters(o,t):h.getTranslatedString("oj-validator.length.hint.inRange",t)):(t={length:m},n=i?h.applyParameters(i,t):h.getTranslatedString("oj-validator.length.hint.exact",t)):null!==m?(t={min:m},n=s?h.applyParameters(s,t):h.getTranslatedString("oj-validator.length.hint.min",t)):null!==l&&(t={max:l},n=r?h.applyParameters(r,t):h.getTranslatedString("oj-validator.length.hint.max",t)),n},e.prototype.validate=function(n){var e,i=this._customMessageDetail,o=this._customMessageSummary,r="",s=this._max,l=o.tooLong,m=o.tooShort,h=i.tooLong,g=i.tooShort,u=this._min,d="",p=a,c=""+n,v=this._getLength(c);if(!(null===u||v>=this._min)||!(null===s||v<=this._max))throw v<this._min?(e={value:n,min:u},d=m?p.applyParameters(m,e):p.getTranslatedString("oj-validator.length.messageSummary.tooShort"),r=g?p.applyParameters(g,e):p.getTranslatedString("oj-validator.length.messageDetail.tooShort",e)):(e={value:n,max:s},d=l?p.applyParameters(l,e):p.getTranslatedString("oj-validator.length.messageSummary.tooLong"),r=h?p.applyParameters(h,e):p.getTranslatedString("oj-validator.length.messageDetail.tooLong",e)),new t.ValidatorError(d,r)},e.prototype._getLength=function(a){var n,e=this._countBy.toLowerCase(),i=a.length,o=0;switch(e){case"codepoint":for(var r=0;r<i;r++)55296==(63488&a.charCodeAt(r))&&(o+=1);t.Assert.assert(o%2==0,"the number of surrogate chars must be an even number."),n=i-o/2;break;case"codeunit":default:n=i}return n},e});